{
    "script_shortcuts": [
        {
            "name": "Open Terminal Admin",
            "description": "Opens PowerShell as administrator",
            "hotkey": "!x",
            "action": "RunWait(\"pwsh -Command `\"cd $env:USERPROFILE; Start-Process pwsh -Verb RunAs`\"\", , \"Hide\")",
            "category": "Script",
            "enabled": false
        },
        {
            "name": "Run Python Script",
            "description": "Opens run.py in the ms1 directory",
            "hotkey": "ScrollLock",
            "action": "run_py_script()\nrun_py_script()\n{\n    Run(\"C:\\@delta\\ms1\\scripts\\run\\Run.py\", , \"Show\")\n    ; Wait a moment for the window to appear\n    Sleep(1000)\n    ; Make the window always on top (assumes it's the active window)\n    ;WinSetAlwaysOnTop(true, \"A\")\n}",
            "category": "Launch",
            "enabled": true
        },
        {
            "name": "Monitor Internal",
            "description": "Switch to internal monitor only",
            "hotkey": "RAlt & Numpad1",
            "action": "Run(\"C:\\@delta\\msBackups\\Display\\DisplaySwitch.exe /internal\", \"\", \"Hide\")",
            "category": "Launch"
        },
        {
            "name": "Monitor External",
            "description": "Switch to external monitor only",
            "hotkey": "RAlt & Numpad2",
            "action": "Run(\"C:\\@delta\\msBackups\\Display\\DisplaySwitch.exe /external\", \"\", \"Hide\")",
            "category": "Launch"
        },
        {
            "name": "Monitor Extend",
            "description": "Extend display to both monitors",
            "hotkey": "RAlt & Numpad3",
            "action": "Run(\"C:\\@delta\\msBackups\\Display\\DisplaySwitch.exe /extend\", \"\", \"Hide\")",
            "category": "Launch"
        },
        {
            "name": "Bio GUI",
            "description": "Opens Bio.ahk GUI",
            "hotkey": "!b",
            "action": "Run(\"C:\\@delta\\ms1\\scripts\\Autohtokey\\version2\\gui\\Bio.ahk\", \"\", \"Hide\")",
            "category": "Launch",
            "enabled": true
        },
        {
            "name": "Ultimate GUI",
            "description": "Opens Ultimate_Gui.py",
            "hotkey": "!u",
            "action": "Run(\"C:\\@delta\\ms1\\TOOLS\\Ultimate_Gui.py\", \"\", \"Hide\")",
            "category": "Launch"
        },
        {
            "name": "Always On Top Toggle",
            "description": "Toggles always on top for active window",
            "hotkey": "#t",
            "action": "Always_on_Top()\nAlways_on_Top(){\n    static alwaysOnTop := false\n    if (alwaysOnTop) {\n        WinSetAlwaysOnTop(false, \"A\")\n    } else {\n        WinSetAlwaysOnTop(true, \"A\")\n    }\n    alwaysOnTop := !alwaysOnTop\n}",
            "category": "Script"
        },
        {
            "name": "Kill Foreground Process",
            "description": "Forcefully kills the process under mouse cursor",
            "hotkey": "!q",
            "action": "KillForeground() {\n    MouseGetPos(, , &WinID)\n    ProcessID := WinGetPID(\"ahk_id \" WinID)\n    Run(\"taskkill /f /pid \" ProcessID, , \"Hide\")\n}",
            "category": "Script",
            "enabled": true
        },
        {
            "name": "Copy Path",
            "description": "",
            "hotkey": "^!m",
            "action": "CopyPath_File()\nCopyPath_File() {\n    ClipboardBackup := ClipboardAll()\n    A_Clipboard := \"\" \n    Send(\"^c\")\n    Errorlevel := !ClipWait(1)\n    if ErrorLevel\n    {\n    MsgBox(\"No valid file path found.\")\n    }\n    else\n    {\n    ClipBoardContent := A_Clipboard\n    ; V1toV2: StrReplace() is not case sensitive\n    ; check for StringCaseSense in v1 source script\n    ; and change the CaseSense param in StrReplace() if necessary\n    ClipBoardContent := StrReplace(ClipBoardContent, \"`n\", \"`t\")\n    A_Clipboard := ClipboardBackup\n    A_Clipboard := ClipBoardContent\n    TrayTip(\"Copy as Path\", \"Copied `\"\" ClipBoardContent \"`\" to clipboard.\")\n    }}",
            "category": "Script"
        },
        {
            "name": "Kill (dnplayer/python/) + Change Display",
            "category": "Script",
            "description": "",
            "hotkey": "^!+r",
            "action": "{\n    ; Kill dnplayer.exe\n    Run(\"taskkill /F /IM dnplayer.exe\",,\"Hide\")\n    ; Kill python.exe\n    Run(\"taskkill /F /IM python.exe\",,\"Hide\")\n    ; Run the command\n    Run(\"C:\\@delta\\msBackups\\Display\\DisplaySwitch.exe /internal\",,\"Hide\")\n}"
        },
        {
            "name": "Script Manager",
            "category": "Launch",
            "description": "",
            "hotkey": "#x",
            "action": "RestartScriptManager()\nRestartScriptManager() {\n    ; Check if the window exists\n    if WinExist(\"SCRIPT // MANAGER\") {\n        ; Get the process ID of the window\n        ProcessID := WinGetPID(\"SCRIPT // MANAGER\")\n        ; Kill the process\n        Run(\"taskkill /f /pid \" ProcessID, , \"Hide\")\n        ; Wait a moment for the process to close\n        Sleep(500)\n    }\n    ; Launch the script\n    Run('pythonw \"C:\\@delta\\db\\@run_from_db\\Script_Manager\\script_manager_gui_qt.py\"')\n    WinWait(\"SCRIPT // MANAGER\")\n    WinActivate(\"SCRIPT // MANAGER\")\n}",
            "enabled": true
        },
        {
            "name": "Startup Setup",
            "category": "Launch",
            "description": "",
            "hotkey": "#s",
            "action": "Run(\"C:\\@delta\\ms1\\@Flask\\4999_startup\\startup.py\", , \"Hide\")"
        },
        {
            "name": "CrossHair",
            "category": "General",
            "description": "",
            "hotkey": "^+m",
            "action": "Run(\"C:\\@delta\\ms1\\scripts\\xy\\XY_CroosHair.py\", , \"Hide\")"
        },
        {
            "name": "Explorer Restart",
            "category": "Script",
            "description": "",
            "hotkey": "LAlt & e",
            "action": "Run('pwsh -c explorer.exe', , 'Hide')"
        },
        {
            "name": "Replace Space with _",
            "category": "Text",
            "description": "",
            "hotkey": "RAlt & Space",
            "action": "replacewith_()\nreplacewith_()\n{\n    ; Backup the clipboard\n    ClipboardBackup := ClipboardAll()\n    ; Clear the clipboard\n    A_Clipboard := \"\"\n    ; Copy the selected text\n    Send(\"^c\")\n    ; Wait for the clipboard to contain the copied text\n    if !ClipWait(1) {\n        MsgBox(\"No text selected or copying failed.\")\n    } else {\n        ; Get the clipboard content\n        ClipboardContent := A_Clipboard\n        ; Replace all spaces with underscores\n        ClipboardContent := StrReplace(ClipboardContent, A_Space, \"_\")\n        ; Put the modified text back in clipboard\n        A_Clipboard := ClipboardContent\n        ; Paste the modified text (this replaces the selected text)\n        Send(\"^v\")\n        ; Wait a moment for the paste to complete\n        Sleep(50)\n    }\n    ; Restore the original clipboard content\n    A_Clipboard := ClipboardBackup\n}"
        },
        {
            "name": "Replace - w Space",
            "category": "Text",
            "description": "",
            "hotkey": "RAlt & -",
            "action": "replacedashwithspace()\nreplacedashwithspace()\n{\n    ; Backup the clipboard\n    ClipboardBackup := ClipboardAll()\n    ; Clear the clipboard\n    A_Clipboard := \"\"\n    ; Copy the selected text\n    Send(\"^c\")\n    ; Wait for the clipboard to contain the copied text\n    if !ClipWait(1) {\n        MsgBox(\"No text selected or copying failed.\")\n    } else {\n        ; Get the clipboard content\n        ClipboardContent := A_Clipboard\n        ; Replace all dashes with spaces\n        ClipboardContent := StrReplace(ClipboardContent, \"-\", A_Space)\n        ; Put the modified text back in clipboard\n        A_Clipboard := ClipboardContent\n        ; Paste the modified text (this replaces the selected text)\n        Send(\"^v\")\n        ; Wait a moment for the paste to complete\n        Sleep(50)\n    }\n    ; Restore the original clipboard content\n    A_Clipboard := ClipboardBackup\n}"
        },
        {
            "name": "Send Apps to 2nd Display",
            "category": "Display",
            "description": "",
            "hotkey": "!1",
            "action": "Run(\"C:\\@delta\\ms1\\scripts\\Autohtokey\\version2\\display\\send_to_2nd.ahk\", \"\", \"Hide\")",
            "enabled": true
        },
        {
            "name": "Open w VScode",
            "category": "General",
            "description": "",
            "hotkey": "^!n",
            "action": "Run(\"C:\\@delta\\ms1\\scripts\\Autohtokey\\version1\\nvim_OpenWith.ahk\", \"\", \"Show\")",
            "enabled": false
        },
        {
            "name": "Center Apps Window",
            "category": "Display",
            "description": "",
            "hotkey": "LAlt & c",
            "action": "Center_Focused_Window()\nCenter_Focused_Window() {\n    ; Get the handle of the active (focused) window\n    hwnd := WinGetID(\"A\")\n    ; Get the position and size of the active window\n    WinGetPos(&x, &y, &w, &h, \"ahk_id \" hwnd)\n    ; Get the screen width and height\n    ScreenWidth := SysGet(78)\n    ScreenHeight := SysGet(79)\n    ; Calculate new position to center the window\n    newX := (ScreenWidth - w) / 2\n    newY := (ScreenHeight - h) / 2\n    ; Move the window to the calculated position\n    WinMove(newX, newY, , , \"ahk_id \" hwnd)\n}"
        },
        {
            "name": "Black Screen",
            "category": "Display",
            "description": "",
            "hotkey": "^!b",
            "action": "Toggle_Screen_Blackout() {\n    static blackoutState := 0\n    static myGui := \"\"\n    \n    if (blackoutState = 0) {\n        blackoutState := 1\n        myGui := Gui()\n        myGui.Opt(\"+LastFound +AlwaysOnTop -Caption +ToolWindow\")\n        myGui.BackColor := \"Black\"\n        myGui.Show(\"w\" . A_ScreenWidth . \" h\" . A_ScreenHeight . \" x0 y0 NoActivate\")\n    } else {\n        blackoutState := 0\n        myGui.Destroy()\n        myGui := \"\"\n    }\n}"
        },
        {
            "name": "White Screen",
            "category": "Display",
            "description": "",
            "hotkey": "^!w",
            "action": "Toggle_Screen_Whiteout() {\n    static whiteState := 0\n    static myGui := \"\"\n    \n    if (whiteState = 0) {\n        whiteState := 1\n        myGui := Gui()\n        myGui.Opt(\"+LastFound +AlwaysOnTop -Caption +ToolWindow\")\n        myGui.BackColor := \"ffffff\"\n        myGui.Show(\"w\" . A_ScreenWidth . \" h\" . A_ScreenHeight . \" x0 y0 NoActivate\")\n    } else {\n        whiteState := 0\n        myGui.Destroy()\n        myGui := \"\"\n    }\n}"
        },
        {
            "name": "Execute Script W/O Closing",
            "category": "General",
            "description": "",
            "hotkey": "^!+Enter",
            "action": "{\n    ClipSaved := ClipboardAll()\n    A_Clipboard := \"\"               ; Clear clipboard\n    ; Get the active window title\n    ActiveTitle := WinGetTitle(\"A\")\n    ; If the active window is VSCode, simulate the shortcut to copy the file path\n    if InStr(ActiveTitle, \"Visual Studio Code\") {\n        ; Simulate VSCode's shortcut to copy the current file path (Shift + Alt + C)\n        Send(\"+!c\")\n        Errorlevel := !ClipWait(1)               ; Wait until clipboard has content\n    } else {\n        ; Send Ctrl+C to copy the selected file path in other environments\n        Send(\"^c\")\n        Errorlevel := !ClipWait(1)               ; Wait until clipboard has content\n    }\n    if (A_Clipboard != \"\") {\n        ; Get the selected file path from the clipboard\n        FilePath := A_Clipboard\n        ; Extract the directory from the file path\n        SplitPath(FilePath, , &FileDir)\n        Ext := SubStr(FilePath, (InStr(FilePath, \".\", 0, -1) + 1)<1 ? (InStr(FilePath, \".\", 0, -1) + 1)-1 : (InStr(FilePath, \".\", 0, -1) + 1))\n        ; Check the extension and run the appropriate command with working directory\n        if (Ext = \"py\") {\n            Run(\"cmd /k python `\"\" FilePath \"`\"\", FileDir, , &PID)\n        } else if (Ext = \"ps1\") {\n            Run(\"cmd /k powershell -ExecutionPolicy Bypass -File `\"\" FilePath \"`\"\", FileDir, , &PID)\n        } else if (Ext = \"bat\") {\n            Run(\"cmd /k `\"\" FilePath \"`\"\", FileDir, , &PID)\n        } else if (Ext = \"ahk\") {\n            Run(\"cmd /k `\"\" FilePath \"`\"\", FileDir, , &PID)\n        } else {\n            MsgBox(\"Unsupported file type: \" Ext)\n        }\n    } else {\n        MsgBox(\"No file path selected or copied.\")\n    }\n    ; Restore original clipboard content\n    A_Clipboard := ClipSaved\n    return\n}"
        },
        {
            "name": "Border",
            "category": "Text",
            "description": "",
            "hotkey": "^+b",
            "action": "AddSmartBorder()\nAddSmartBorder()\n{\n    ; Copy selected text\n    A_Clipboard := \"\"\n    Send(\"^c\")\n    ClipWait(1)\n    if !A_Clipboard {\n        MsgBox \"Nothing selected!\"\n        return\n    }\n    \n    ; Detect language/file type from window title\n    activeTitle := WinGetTitle(\"A\")\n    commentStyle := DetectCommentStyle(activeTitle)\n    \n    ; Split into lines and normalize tabs → spaces\n    rawLines := StrSplit(A_Clipboard, \"`n\", \"`r\")\n    maxLen := 0\n    for i, line in rawLines {\n        clean := StrReplace(line, \"`t\", \"    \")\n        rawLines[i] := clean\n        if (StrLen(clean) > maxLen)\n            maxLen := StrLen(clean)\n    }\n    \n    ; Build borders (only borders are commented, content stays as-is)\n    borderChar := commentStyle.border\n    topBorder := commentStyle.prefix . \" \" . StrRepeat(borderChar, maxLen + 3)\n    bottomBorder := topBorder\n    \n    ; Assemble output: commented borders + content with commented side borders\n    output := topBorder . \"`r`n\"\n    for line in rawLines {\n        ; Calculate padding to align vertical border with horizontal border end\n        padding := StrRepeat(\" \", maxLen + 4 - StrLen(line))\n        output .= line . padding . commentStyle.prefix . \"`r`n\"\n    }\n    output .= bottomBorder\n    \n    ; Replace selection with bordered text\n    A_Clipboard := output\n    Sleep 50\n    Send(\"^v\")\n}\n\nDetectCommentStyle(windowTitle) {\n    ; Convert to lowercase for easier matching\n    title := StrLower(windowTitle)\n    \n    ; Detect based on file extension or application\n    if (InStr(title, \".py\") || InStr(title, \"python\") || InStr(title, \"pycharm\")) {\n        return {type: \"line\", prefix: \"#\", border: \"#\"}\n    } else if (InStr(title, \".ps1\") || InStr(title, \"powershell\") || InStr(title, \"ise\")) {\n        return {type: \"line\", prefix: \"#\", border: \"#\"}\n    } else if (InStr(title, \".css\")) {\n        return {type: \"line\", prefix: \"/*\", border: \"*\"}\n    } else if (InStr(title, \".js\") || InStr(title, \".ts\") || InStr(title, \".java\") || InStr(title, \".c\") || InStr(title, \".cpp\")) {\n        return {type: \"line\", prefix: \"//\", border: \"/\"}\n    } else if (InStr(title, \".ahk\") || InStr(title, \"autohotkey\")) {\n        return {type: \"line\", prefix: \";\", border: \"#\"}\n    } else if (InStr(title, \".bat\") || InStr(title, \".cmd\")) {\n        return {type: \"line\", prefix: \"REM\", border: \"=\"}\n    } else {\n        ; Default fallback\n        return {type: \"line\", prefix: \"#\", border: \"#\"}\n    }\n}\n\nStrRepeat(char, count) {\n    result := \"\"\n    Loop count\n        result .= char\n    return result\n}"
        },
        {
            "name": "Merge all window in a single explorer",
            "category": "General",
            "description": "",
            "hotkey": "#e",
            "action": "MergeAllExplorerWindows()\n\nMergeAllExplorerWindows() {\n    ; Get the target window to merge everything into\n    mainWindow := WinActive(\"ahk_class CabinetWClass\")\n    if (!mainWindow)\n        mainWindow := WinExist(\"ahk_class CabinetWClass\")\n    \n    if (!mainWindow) {\n        Run(\"explorer.exe\")\n        return\n    }\n\n    pathsToOpen := []\n    sourceHwnds := Map()\n\n    ; Collect all paths from all explorer tabs\n    shellApp := ComObject(\"Shell.Application\")\n    \n    for window in shellApp.Windows {\n        try {\n            if (window.Name != \"Windows Explorer\" && window.Name != \"File Explorer\")\n                continue\n                \n            thisHwnd := 0\n            try {\n                thisHwnd := window.HWND\n            } catch {\n                continue\n            }\n            \n            if (!thisHwnd || thisHwnd == 0)\n                continue\n\n            if (thisHwnd != mainWindow) {\n                path := \"\"\n                try {\n                    path := window.Document.Folder.Self.Path\n                } catch {\n                    try {\n                        path := window.LocationURL\n                    } catch {\n                        path := window.LocationName\n                    }\n                }\n                \n                if (path != \"\" && path != \"This PC\") {\n                    pathsToOpen.Push(path)\n                    sourceHwnds[thisHwnd] := true\n                }\n            }\n        } catch {\n            continue\n        }\n    }\n\n    if (pathsToOpen.Length == 0 && sourceHwnds.Count == 0) {\n        return\n    }\n\n    ; Backup clipboard\n    clipSaved := ClipboardAll()\n\n    WinActivate(\"ahk_id \" . mainWindow)\n    if (!WinWaitActive(\"ahk_id \" . mainWindow, , 2)) {\n        A_Clipboard := clipSaved\n        return\n    }\n\n    ; --- DELIBERATE AND STABLE NAVIGATION ---\n    for p in pathsToOpen {\n        cleanPath := p\n        \n        if InStr(cleanPath, \"file:///\") {\n            cleanPath := StrReplace(cleanPath, \"file:///\", \"\")\n            cleanPath := StrReplace(cleanPath, \"/\", \"\\\")\n            cleanPath := StrReplace(cleanPath, \"%20\", \" \")\n        }\n        \n        ; 1. Create a new tab and wait for animation to complete\n        Send(\"^t\")\n        Sleep(800) ; Increased for stability\n        \n        ; 2. Focus address bar\n        Send(\"^l\")\n        Sleep(400)\n        \n        ; 3. Clear existing text just in case\n        Send(\"^a\") ; Select all\n        Sleep(100)\n        Send(\"{BackSpace}\")\n        Sleep(200)\n        \n        ; 4. Update clipboard and PASTE\n        A_Clipboard := cleanPath\n        Sleep(200) ; Give OS time to register clipboard change\n        Send(\"^v\")\n        Sleep(400) ; Crucial: Wait for the text to actually appear in the box\n        \n        ; 5. Navigation\n        Send(\"{Enter}\")\n        Sleep(1000) ; Wait for navigation to commit before moving to the next tab\n    }\n\n    ; Restore original clipboard\n    A_Clipboard := clipSaved\n\n    ; Close other windows\n    for hwnd, _ in sourceHwnds {\n        try {\n            if WinExist(\"ahk_id \" . hwnd) {\n                WinClose(\"ahk_id \" . hwnd)\n                if (WinExist(\"ahk_id \" . hwnd)) {\n                    Sleep(500)\n                    WinKill(\"ahk_id \" . hwnd)\n                }\n            }\n        }\n    }\n\n    WinActivate(\"ahk_id \" . mainWindow)\n}",
            "enabled": true
        },
        {
            "name": "autofill job field",
            "category": "General",
            "description": "",
            "hotkey": "!n",
            "action": "Run(\"C:\\@delta\\msBackups\\@JOB\\autofill.ahk\", \"\", \"Hide\")",
            "enabled": false
        },
        {
            "name": "Open With Preferred Editor",
            "category": "General",
            "description": "",
            "hotkey": "^!n",
            "action": "OpenWithEditor() {\n    ; Backup current clipboard content\n    ClipboardBackup := ClipboardAll()\n    \n    ; Clear clipboard and copy the selected file path\n    A_Clipboard := \"\"\n    Send(\"^c\")\n    if !ClipWait(1) {\n        MsgBox(\"No valid file path found.\")\n        A_Clipboard := ClipboardBackup\n        return\n    }\n    \n    ClipBoardContent := A_Clipboard\n    if InStr(ClipBoardContent, \"\\\") {\n        ; Handle multiple files (split by newline)\n        FilePaths := \"\"\n        Loop Parse, ClipBoardContent, \"`n\", \"`r\" {\n            if (A_LoopField != \"\") {\n                FilePaths .= '\"' . A_LoopField . '\" '\n            }\n        }\n        if (FilePaths != \"\") {\n            ; Use pythonw to run without console window\n            Run('pythonw \"C:\\@delta\\ms1\\scripts\\run\\editor_chooser.py\" ' . FilePaths, , \"Hide\")\n        }\n    } else {\n        MsgBox(\"No valid file path found.\")\n    }\n    \n    ; Restore original clipboard content\n    A_Clipboard := ClipboardBackup\n}",
            "enabled": true
        },
        {
            "name": "komorebi stop/start",
            "category": "General",
            "description": "",
            "hotkey": "^+k",
            "action": "komo_start_stop()\nkomo_start_stop() {\nRunWait \"powershell.exe -Command Stop-Process -Name komorebi -ErrorAction SilentlyContinue\", , \"Hide\"\nRun \"komorebic.exe start\", , \"Hide\"\n}",
            "enabled": true
        },
        {
            "name": "Quick Shortcut",
            "category": "Text",
            "description": "Sleep 250 //    Send \" -> \"",
            "hotkey": "^q",
            "action": "KeySequence()\nKeySequence() {\n    Send \"^!{Numpad2}\"\n    Sleep 250\n    Send \"{Enter}\"\n    Sleep 250\n    Send \"^!{Numpad1}\"\n}",
            "enabled": true
        },
        {
            "name": "Take Screenshot",
            "category": "General",
            "description": "",
            "hotkey": "PrintScreen",
            "action": "Run(\"C:\\@delta\\ms1\\scripts\\Autohtokey\\version2\\gui\\Bio.ahk\", \"\", \"Hide\")",
            "enabled": true
        },
        {
            "name": "Open Folder gui",
            "category": "General",
            "description": "",
            "hotkey": "#f",
            "action": "Run(\"C:\\@delta\\ms1\\Testing\\screenshot\\folder_launcher\\launcher.py\", \"\", \"Hide\")",
            "enabled": true
        },
        {
            "name": "Gallery View",
            "category": "General",
            "description": "",
            "hotkey": "#v",
            "action": "Run(\"C:\\@delta\\ms1\\Testing\\screenshot\\gallery\\gallery.py\", \"\", \"Hide\")",
            "enabled": true
        },
        {
            "name": "DropClipboard Insert To Field",
            "category": "General",
            "description": "",
            "hotkey": "^+i",
            "action": "DropClipboard()\nDropClipboard() {\n    ; 1. Get current text from clipboard\n    clipText := A_Clipboard\n    if (clipText == \"\") {\n        ShowNotification(\"Clipboard is empty!\", \"Warning\")\n        return\n    }\n\n\n    ; 2. Create a temporary folder and file\n    tempDir := A_Temp \"\\AutoInsert\"\n    if !DirExist(tempDir)\n        DirCreate(tempDir)\n    \n    ; Create a unique filename using timestamp\n    fileName := \"clip_\" A_Now \"_\" A_TickCount \".txt\"\n    filePath := tempDir \"\\\" fileName\n    \n    try {\n        ; Write clipboard content to the new file with UTF-8 encoding (supports Bangla, etc.)\n        if FileExist(filePath)\n            FileDelete(filePath)\n        ; \"UTF-8\" includes the BOM (Byte Order Mark), which helps Windows apps recognize the text as Unicode.\n        FileAppend(clipText, filePath, \"UTF-8\")\n    } catch Error as err {\n        MsgBox(\"Failed to create temporary file:`n\" err.Message)\n        return\n    }\n\n\n    ; 3. Prepare the Clipboard for \"Smart Drop\"\n    ; We set both File (CF_HDROP) and Text (CF_UNICODETEXT) formats.\n    ; This allows Windows to decide: if it's a folder, drop the file; if it's a text field, paste the path.\n    if !SetClipboardSmart(filePath) {\n        MsgBox(\"Failed to set clipboard data.\")\n        return\n    }\n\n\n    ; 4. Perform the \"Drop\" action\n    ; Get window and position under mouse\n    MouseGetPos(&mX, &mY, &hWnd)\n    \n    ; Optional: Activate the window to ensure it receives the focus/paste\n    try {\n        WinActivate(\"ahk_id \" hWnd)\n    }\n    \n    ; Small click to focus the exact element under the mouse\n    Click(mX, mY)\n    Sleep(100) ; Wait for focus to settle\n    \n    ; Send Paste command\n    Send(\"^v\")\n\n\n    ShowNotification(\"Dropped: \" fileName \"`n(File & Path ready)\", \"Success\")\n}\n\n\n; --- Helper Functions ---\n\n\n/**\n * Sets the clipboard to contain both the file object (for dropping into folders/apps)\n * and the file path string (for pasting into text fields).\n */\nSetClipboardSmart(filePath) {\n    if !DllCall(\"OpenClipboard\", \"ptr\", A_ScriptHwnd)\n        return false\n    \n    DllCall(\"EmptyClipboard\")\n\n\n    ; -- 1. Set CF_UNICODETEXT (Pasting path into text fields) --\n    hText := DllCall(\"GlobalAlloc\", \"uint\", 0x42, \"ptr\", (StrLen(filePath) + 1) * 2, \"ptr\")\n    pText := DllCall(\"GlobalLock\", \"ptr\", hText, \"ptr\")\n    StrPut(filePath, pText, \"UTF-16\")\n    DllCall(\"GlobalUnlock\", \"ptr\", hText)\n    DllCall(\"SetClipboardData\", \"uint\", 13, \"ptr\", hText) ; 13 = CF_UNICODETEXT\n\n\n    ; -- 2. Set CF_HDROP (Dropping file into folders/browser uploads) --\n    ; DROPFILES structure is 20 bytes\n    charCount := StrLen(filePath) + 2 ; +1 for null, +1 for double null (required for file lists)\n    hDrop := DllCall(\"GlobalAlloc\", \"uint\", 0x42, \"ptr\", 20 + (charCount * 2), \"ptr\")\n    pDrop := DllCall(\"GlobalLock\", \"ptr\", hDrop, \"ptr\")\n    \n    NumPut(\"uint\", 20, pDrop, 0)   ; pFiles: offset to file list\n    NumPut(\"uint\", 1, pDrop, 16)  ; fWide: 1 means Unicode\n    \n    ; Copy path to the offset 20\n    StrPut(filePath, pDrop + 20, \"UTF-16\")\n    ; Double null termination (already handled by GlobalAlloc zero-init, but for safety:)\n    NumPut(\"ushort\", 0, pDrop + 20 + (StrLen(filePath) * 2), 0)\n    \n    DllCall(\"GlobalUnlock\", \"ptr\", hDrop)\n    DllCall(\"SetClipboardData\", \"uint\", 15, \"ptr\", hDrop) ; 15 = CF_HDROP\n\n\n    DllCall(\"CloseClipboard\")\n    return true\n}\n\n\nShowNotification(msg, title := \"\") {\n    ToolTip(title ? title \": \" msg : msg)\n    SetTimer(() => ToolTip(), -2500)\n}",
            "enabled": true
        },
        {
            "name": "Go To SleepMode",
            "category": "General",
            "description": "",
            "hotkey": "#l",
            "action": "GoToSleep() {\n    ; 0 = Standby (Sleep), 1 = Hibernate\n    DllCall(\"PowrProf\\SetSuspendState\", \"Int\", 0, \"Int\", 0, \"Int\", 0)\n}",
            "enabled": true
        },
        {
            "name": "Komorebi W1",
            "category": "General",
            "description": "",
            "hotkey": "#1",
            "action": "Run(\"komorebic.exe focus-workspace 0\", , \"Hide\")",
            "enabled": true
        },
        {
            "name": "Komorebi W2",
            "category": "General",
            "description": "",
            "hotkey": "#2",
            "action": "Run(\"komorebic.exe focus-workspace 1\", , \"Hide\")",
            "enabled": true
        },
        {
            "name": "Komorebi Toggle Workspace",
            "category": "General",
            "description": "",
            "hotkey": "#q",
            "action": "{\n    ; Static variables keep their value between keypresses\n    static toggle := 0\n    \n    if (toggle == 0) {\n        Run(\"komorebic.exe focus-workspace 1\", , \"Hide\")\n        toggle := 1\n    } else {\n        Run(\"komorebic.exe focus-workspace 0\", , \"Hide\")\n        toggle := 0\n    }\n}",
            "enabled": true
        }
    ],
    "text_shortcuts": [
        {
            "name": "AutoHotkey Version 1",
            "description": "Inserts AHK v1 header requirement",
            "trigger": ";v1",
            "replacement": "#Requires AutoHotkey v1.0",
            "category": "AHK",
            "enabled": true
        },
        {
            "name": "AutoHotkey Version 2",
            "description": "Inserts AHK v2 header requirement",
            "trigger": ";v2",
            "replacement": "{#}Requires AutoHotkey v2.0",
            "category": "AHK",
            "enabled": true
        },
        {
            "name": "Registry Run Path",
            "description": "Windows startup registry path run",
            "trigger": ";run",
            "replacement": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
            "category": "Path"
        },
        {
            "name": "PowerShell Symlink",
            "description": "PowerShell command to create symbolic link",
            "trigger": ";mklink",
            "replacement": "New-Item -ItemType SymbolicLink -Path \"Fake\" -Target \"Original\" -Force",
            "category": "Shell"
        },
        {
            "name": "Symbols",
            "description": "  󰩷  󰣉  󰁄 󰁌 󰞘 󰜴 󱞩 󱞫 󰤼",
            "trigger": ";--",
            "replacement": "",
            "category": "Icon/Emoji/Sign"
        },
        {
            "name": "Star",
            "category": "Icon/Emoji/Sign",
            "description": "",
            "trigger": ";star",
            "replacement": ""
        },
        {
            "name": "Db path",
            "category": "Path",
            "description": "",
            "trigger": ";db",
            "replacement": "C:\\@delta\\db"
        },
        {
            "name": "Changes for Ai to know that i made on my files",
            "category": "General",
            "description": "",
            "trigger": ";change",
            "replacement": "ok i have made some changes from last time  so keep that in mind now",
            "enabled": true
        },
        {
            "name": "Percentage %",
            "category": "Text",
            "description": "",
            "trigger": ";%",
            "replacement": "℅",
            "enabled": true
        },
        {
            "name": "not equal",
            "category": "Math Sign",
            "description": "",
            "trigger": ";notequal",
            "replacement": "≠",
            "enabled": true
        },
        {
            "name": "Theta Sign",
            "category": "Math Sign",
            "description": "",
            "trigger": ";theta",
            "replacement": "θ",
            "enabled": true
        },
        {
            "name": "Custom Syntex [Half]",
            "category": "General",
            "description": "",
            "trigger": ";cms",
            "replacement": "make a study note for this\nmd syntex formet is a bit different here is how i use them\n\n#1.5#text#/#  = extra big text\n##text##  = big text\n**text** = bold text\n@@text@@ = italic text\n__text__ = underline\n- text = list 1\n-- text = list 2\n--- text = list 3\nDont add unnecessary extra lines between heading and its content\ndont use --- or dash to add separator just keep single empty line for spacing\nfor math use katex or latex formatting with \\(Math\\) or $Math$",
            "enabled": true
        },
        {
            "name": "Cyberpunk styling with pyqt",
            "category": "General",
            "description": "",
            "trigger": ";cyberpunk",
            "replacement": "# Cyberpunk UI Theme Guide\n\n\nA reusable styling reference for PyQt6 applications with a dark, neon-accented cyberpunk aesthetic.\n\n\n---\n\n\n## Color Palette\n\n\n```python\n# Core Colors\nCP_BG = \"#050505\"           # Main Background (almost black)\nCP_PANEL = \"#111111\"        # Panel/Card Background\nCP_DIM = \"#3a3a3a\"          # Dimmed/Inactive elements, borders\n\n\n# Text Colors\nCP_TEXT = \"#E0E0E0\"         # Primary text\nCP_SUBTEXT = \"#808080\"      # Secondary/muted text\n\n\n# Accent Colors\nCP_YELLOW = \"#FCEE0A\"       # Primary accent (Cyber Yellow)\nCP_CYAN = \"#00F0FF\"         # Secondary accent (Neon Cyan)\nCP_RED = \"#FF003C\"          # Error/Delete/Danger\nCP_GREEN = \"#00FF00\"        # Success/Confirm\nCP_MAGENTA = \"#FF00FF\"      # Alternate accent\nCP_ORANGE = \"#FFA500\"       # Warning/Highlight\n```\n\n\n---\n\n\n## Typography\n\n\n- **Primary Font:** `Consolas` (monospace)\n- **Fallback:** Any monospace font\n- **Weights:** Normal (400), Bold (700)\n- **Sizes:**\n  - Headers: 16px bold\n  - Section titles: 11-12px bold\n  - Body text: 10-11px\n  - Labels/Status: 8-9px\n  - Timestamps: 7px\n\n\n```python\nfrom PyQt6.QtGui import QFont\n\n\n# Header\nQFont(\"Consolas\", 16, QFont.Weight.Bold)\n\n\n# Section Title\nQFont(\"Consolas\", 11, QFont.Weight.Bold)\n\n\n# Body/Button\nQFont(\"Consolas\", 10, QFont.Weight.Bold)\n\n\n# Small Labels\nQFont(\"Consolas\", 8)\n```\n\n\n---\n\n\n## Button Styles\n\n\n### Solid Button (Primary Action)\n```python\nQPushButton {\n    background-color: #FCEE0A;\n    color: #050505;\n    border: none;\n    padding: 5px 15px;\n    font-family: 'Consolas';\n    font-weight: bold;\n}\nQPushButton:hover {\n    background-color: #050505;\n    color: #FCEE0A;\n    border: 1px solid #FCEE0A;\n}\n```\n\n\n### Outlined Button (Secondary Action)\n```python\nQPushButton {\n    background-color: transparent;\n    color: #FCEE0A;\n    border: 2px solid #FCEE0A;\n    padding: 5px 15px;\n    font-family: 'Consolas';\n    font-weight: bold;\n}\nQPushButton:hover {\n    background-color: #FCEE0A;\n    color: #050505;\n}\n```\n\n\n### Danger Button\n```python\nQPushButton {\n    background-color: transparent;\n    color: #FF003C;\n    border: 2px solid #FF003C;\n    padding: 5px 15px;\n    font-family: 'Consolas';\n}\nQPushButton:hover {\n    background-color: #FF003C;\n    color: #050505;\n}\n```\n\n\n---\n\n\n## Input Fields\n\n\n```python\nQLineEdit {\n    background-color: #111111;\n    color: #FCEE0A;\n    border: 1px solid #3a3a3a;\n    padding: 8px;\n    font-family: 'Consolas';\n}\nQLineEdit:focus {\n    border: 1px solid #00F0FF;\n}\nQLineEdit::placeholder {\n    color: #808080;\n}\n```\n\n\n---\n\n\n## Dropdown / ComboBox\n\n\n```python\nQComboBox {\n    background-color: transparent;\n    color: #00F0FF;\n    border: 1px solid #00F0FF;\n    padding: 5px 15px;\n    font-family: 'Consolas';\n    font-weight: bold;\n}\nQComboBox:hover {\n    background-color: #00F0FF;\n    color: #050505;\n}\nQComboBox::drop-down {\n    border: 0px;\n    width: 0px;\n}\nQComboBox QAbstractItemView {\n    background-color: #111111;\n    color: #E0E0E0;\n    selection-background-color: #00F0FF;\n    selection-color: #050505;\n    border: 1px solid #00F0FF;\n    outline: none;\n}\n```\n\n\n---\n\n\n## Checkbox\n\n\n```python\nQCheckBox {\n    color: #E0E0E0;\n    font-family: 'Consolas';\n    font-size: 11px;\n    spacing: 10px;\n    padding: 10px;\n    border: 1px solid #111111;\n    background: #111111;\n}\nQCheckBox::indicator {\n    width: 14px;\n    height: 14px;\n    border: 1px solid #3a3a3a;\n    background: #050505;\n}\nQCheckBox::indicator:checked {\n    background: #FCEE0A;\n    border: 1px solid #FCEE0A;\n}\nQCheckBox::indicator:hover {\n    border: 1px solid #00F0FF;\n}\nQCheckBox:hover {\n    border: 1px solid #3a3a3a;\n    background: #1a1a25;\n}\n```\n\n\n---\n\n\n## Context Menu\n\n\n```python\nQMenu {\n    background-color: #050505;\n    color: #E0E0E0;\n    border: 1px solid #00F0FF;\n    font-family: 'Consolas';\n}\nQMenu::item {\n    padding: 6px 25px;\n    background-color: transparent;\n}\nQMenu::item:selected {\n    background-color: #00F0FF;\n    color: #050505;\n}\n```\n\n\n---\n\n\n## Scrollbar\n\n\n```python\nQScrollBar:vertical {\n    background: #050505;\n    width: 8px;\n}\nQScrollBar::handle:vertical {\n    background: #3a3a3a;\n}\nQScrollBar::handle:vertical:hover {\n    background: #00F0FF;\n}\n```\n\n\n---\n\n\n## Cards / List Items\n\n\n```python\n/* Item card with left accent border */\nQFrame {\n    background-color: #0f0f15;\n    border-left: 3px solid #FCEE0A;  /* Active state */\n    border-bottom: 1px solid #111111;\n}\nQFrame:hover {\n    background-color: #1a1a25;\n}\n\n\n/* Inactive state: change border-left to #3a3a3a */\n```\n\n\n---\n\n\n## Status Toggle Button\n\n\n```python\n/* Active State */\nQPushButton {\n    background-color: #FCEE0A;\n    color: #050505;\n    border: 1px solid #FCEE0A;\n    border-radius: 0px;\n}\n\n\n/* Inactive State */\nQPushButton {\n    background-color: transparent;\n    color: #808080;\n    border: 1px solid #3a3a3a;\n    border-radius: 0px;\n}\nQPushButton:hover {\n    border: 1px solid #00F0FF;\n    color: #00F0FF;\n}\n```\n\n\n---\n\n\n## Dialog Windows\n\n\n```python\nQDialog {\n    background-color: #050505;\n    border: 1px solid #3a3a3a;\n}\nQDialog QLabel {\n    color: #00F0FF;\n    font-family: 'Consolas';\n    font-weight: bold;\n    font-size: 12px;\n}\n```\n\n\n---\n\n\n## Headers & Labels\n\n\n```python\n/* Main Title */\nQLabel {\n    color: #FCEE0A;\n    font-family: 'Consolas';\n    font-size: 16px;\n    font-weight: bold;\n    letter-spacing: 2px;\n}\n\n\n/* Section Header */\nQLabel {\n    color: #808080;\n    font-family: 'Consolas';\n    font-size: 11px;\n    font-weight: bold;\n    padding-bottom: 5px;\n    border-bottom: 2px solid #3a3a3a;\n}\n\n\n/* Status Text */\nQLabel {\n    color: #00F0FF;\n    font-family: 'Consolas';\n    font-size: 10px;\n}\n```\n\n\n---\n\n\n## Splitter\n\n\n```python\nQSplitter::handle {\n    background-color: #3a3a3a;\n}\nQSplitter::handle:hover {\n    background-color: #00F0FF;\n}\n```\n\n\n---\n\n\n## Design Principles\n\n\n1. **Dark Foundation:** Near-black backgrounds (#050505, #111111)\n2. **Neon Accents:** Yellow for primary, Cyan for secondary, Red for danger\n3. **Monospace Typography:** Consolas throughout for that terminal/hacker feel\n4. **Sharp Edges:** No border-radius (0px) for that angular cyberpunk look\n5. **Hover States:** Invert colors on hover (bg becomes text color, text becomes bg)\n6. **Left Border Accents:** Use colored left borders to indicate state/importance\n7. **Uppercase Text:** Headers and labels in uppercase for impact\n8. **Minimal Padding:** Tight, efficient layouts\n9. **Status Indicators:** Text-based (\"ON\"/\"OFF\", \"ACTV\") rather than icons\n\n\n---\n\n\n## Naming Conventions\n\n\nUse tech/system-inspired terminology:\n- \"EXECUTE PROTOCOL\" instead of \"Run\"\n- \"PURGE ENTRY\" instead of \"Delete\"\n- \"EDIT CONFIG\" instead of \"Edit\"\n- \"SCAN_SYS\" instead of \"Scan System\"\n- \"UPLOAD\" instead of \"Save\"\n- \"ABORT\" instead of \"Cancel\"\n- \"IDENTITY // NAME\" instead of \"Name\"\n- \"SOURCE // PATH\" instead of \"Path\"\n\n\n---\n\n\n## Quick Start Template\n\n\n```python\nfrom PyQt6.QtWidgets import QApplication, QMainWindow\nfrom PyQt6.QtGui import QFont\n\n\n# Palette\nCP_BG = \"#050505\"\nCP_PANEL = \"#111111\"\nCP_YELLOW = \"#FCEE0A\"\nCP_CYAN = \"#00F0FF\"\nCP_RED = \"#FF003C\"\nCP_DIM = \"#3a3a3a\"\nCP_TEXT = \"#E0E0E0\"\nCP_SUBTEXT = \"#808080\"\n\n\nclass MainWindow(QMainWindow):\n    def __init__(self):\n        super().__init__()\n        self.setStyleSheet(f\"QMainWindow {{ background-color: {CP_BG}; }}\")\n        # ... your UI setup\n\n\nif __name__ == \"__main__\":\n    app = QApplication([])\n    app.setStyle(\"Fusion\")  # Important for consistent styling\n    window = MainWindow()\n    window.show()\n    app.exec()\n```\n\n\n---\n\n\n*Generated from startup.py cyberpunk theme implementation*",
            "enabled": true
        },
        {
            "name": "Check summary and unorganized data in ai",
            "category": "General",
            "description": "",
            "trigger": ";check",
            "replacement": "here is everything added to summary or it missed something",
            "enabled": true
        },
        {
            "name": "AI Instruction Prompt 1",
            "category": "General",
            "description": "",
            "trigger": ";commit",
            "replacement": "IMPORTANT:\n- here when i say commit then commit the current changes in my github and then push\n- only commit when i type \"commit\"\n- use emoji ✅when resolved any bug and ⚠️ when facing any issue etc to make the commit message more attractive\n- also first update the md files then commit [update whatever md files needs update like recent changes, problem solving md, new feature md etc]\n- use only 1 line for commit message",
            "enabled": true
        },
        {
            "name": "AI - Instruction For md file",
            "category": "General",
            "description": "",
            "trigger": ";ai1",
            "replacement": "For Projects Always create a Dev.md file and discuss important thing about the project general idea important things etc and also make a md directory where u will add Provlems_Solution.md where u will update  problems and how we resolved them in this structure\n\n## Template for New Entries\n## [YYYY-MM-DD HH:MM] - Brief Problem Title\n\n**Problem:** \nDescription of the issue observed\n\n**Root Cause:** \nWhat was actually causing the problem\n\n**Solution:** \nHow it was fixed (include key code changes)\n\n**Files Modified:**\n- `file1.js` - Brief description of change\n- `file2.css` - Brief description of change\n\n**Related Issues:** Links to related problems or \"None\"",
            "enabled": true
        },
        {
            "name": "Unresolved ai orompt",
            "category": "General",
            "description": "",
            "trigger": ";unresolved",
            "replacement": "still shows as power in both checked and unchecked situatin ok add it to problem & talk about how u tried to reslove it i will use another ai",
            "enabled": true
        },
        {
            "name": "path fix in python script",
            "category": "General",
            "description": "",
            "trigger": ";path",
            "replacement": "SCRIPT_DIR = os.path.dirname(os.path.abspath(__file__))\nCONFIG_FILE = os.path.join(SCRIPT_DIR, \"projects_config.json\")",
            "enabled": true
        },
        {
            "name": "er",
            "category": "ENG -> Bengla",
            "description": "",
            "trigger": ";er",
            "replacement": "এর",
            "enabled": true
        },
        {
            "name": "Theme Guidlines & Rules",
            "category": "General",
            "description": "",
            "trigger": ";theme",
            "replacement": "For theming C:\\@delta\\ms1\\THEME_GUIDE.md use this file guidline u can use cat or some other command to see whats inside THEME_GUIDE.md",
            "enabled": true
        },
        {
            "name": "Bengla e",
            "category": "General",
            "description": "",
            "trigger": ";e",
            "replacement": "ে",
            "enabled": true
        },
        {
            "name": "bangla er",
            "category": "General",
            "description": "",
            "trigger": ";er",
            "replacement": "এর",
            "enabled": true
        }
    ],
    "startup_scripts": [
        {
            "name": "Macro Recorder (Vim Style)",
            "category": "System",
            "description": "Ctrl+R to Record/Stop, Ctrl+E to Playback",
            "action": ";! Macro Recorder Logic\nGlobal MacroBuffer := []\nGlobal IsRecordingMacro := false\n\n; Use a dedicated InputHook to capture all keys including modifiers\nGlobal MacroHook := InputHook(\"V\")\nMacroHook.KeyOpt(\"{All}\", \"N\")\nMacroHook.OnKeyDown := (hook, vk, sc) => MacroBuffer.Push(\"{vk\" . Format(\"{:X}\", vk) . \"sc\" . Format(\"{:X}\", sc) . \"}\")\n\n^r:: { ; Ctrl+R to toggle recording\n    Global IsRecordingMacro, MacroBuffer\n    if !IsRecordingMacro {\n        MacroBuffer := []\n        IsRecordingMacro := true\n        MacroHook.Start()\n        ToolTip(\"● RECORDING MACRO\")\n        SetTimer(() => ToolTip(), -1000)\n    } else {\n        MacroHook.Stop()\n        IsRecordingMacro := false\n        ; Remove the last key (the Ctrl+R that stopped the recording)\n        if MacroBuffer.Length > 0\n            MacroBuffer.Pop()\n        ToolTip(\"■ MACRO SAVED\")\n        SetTimer(() => ToolTip(), -1000)\n    }\n}\n\n^e:: { ; Ctrl+E to Playback\n    Global IsRecordingMacro, MacroBuffer\n    if IsRecordingMacro || MacroBuffer.Length == 0\n        return\n    \n    ToolTip(\"▶ PLAYING\")\n    SetTimer(() => ToolTip(), -500)\n    \n    ; Play back with small delay for stability\n    for key in MacroBuffer {\n        SendEvent(key)\n        Sleep(5)\n    }\n}",
            "enabled": true
        },
        {
            "name": "Smart Bengali Numbers",
            "category": "Text",
            "description": "Converts ;[numbers] to Bengali after Space (Fixed letters conflict)",
            "action": "~;:: {\n    static en_to_bn := Map(\n        \"0\", \"০\", \"1\", \"১\", \"2\", \"২\", \"3\", \"৩\", \"4\", \"৪\",\n        \"5\", \"৫\", \"6\", \"৬\", \"7\", \"৭\", \"8\", \"৮\", \"9\", \"৯\"\n    )\n    \n    ih := InputHook(\"V\", \"{Space}{Enter}{Tab}{Esc}\")\n    \n    ; Nested function for character validation\n    ih.OnChar := OnCharHandler\n    OnCharHandler(h, char) {\n        if !(char ~= \"^\\d$\")\n            h.Stop()\n    }\n    \n    ih.Start()\n    ih.Wait()\n    \n    if (ih.EndReason == \"EndKey\" && ih.Input != \"\") {\n        en_digits := ih.Input\n        bn_digits := \"\"\n        Loop Parse, en_digits\n            bn_digits .= en_to_bn[A_LoopField]\n        \n        bs_count := StrLen(en_digits) + 2\n        \n        if (ih.EndKey == \"Enter\") {\n            Send \"{BackSpace}{BackSpace \" . (bs_count - 1) . \"}\"\n            SendInput bn_digits\n            Send \"{Enter}\"\n        } else {\n            Send \"{BackSpace \" . bs_count . \"}\"\n            SendInput bn_digits\n            Send \"{\" . ih.EndKey . \"}\"\n        }\n    }\n}",
            "enabled": true
        },
        {
            "name": "Explorer Tabs Hook",
            "category": "General",
            "description": "",
            "action": ";! Explorer Tabs Hook\n; Register the shell hook to listen for window creation\nDllCall(\"RegisterShellHookWindow\", \"Ptr\", A_ScriptHwnd)\nmsgNum := DllCall(\"RegisterWindowMessage\", \"Str\", \"SHELLHOOK\")\nOnMessage(msgNum, ShellMessage)\n\n\nShellMessage(wParam, lParam, *) {\n    if (wParam == 1) { ; HSHELL_WINDOWCREATED\n        try {\n            if (WinGetClass(lParam) == \"CabinetWClass\") {\n                ; Found a new Explorer window, wait briefly to let it initialize and then process\n                SetTimer(MergeTab.Bind(lParam), -100)\n            }\n        }\n    }\n}\n\n\nMergeTab(hNewWnd) {\n    ; Wait for the window to actually exist\n    if !WinExist(hNewWnd)\n        return\n\n\n    ; Get list of all Explorer windows\n    allExplorers := WinGetList(\"ahk_class CabinetWClass\")\n    targetWnd := 0\n    \n    ; Find an existing explorer window that isn't the new one\n    for hWnd in allExplorers {\n        if (hWnd != hNewWnd) {\n            targetWnd := hWnd\n            break\n        }\n    }\n\n\n    if (targetWnd) {\n        newPath := \"\"\n        \n        ; Retry loop to get the path (sometimes COM object is slow to update)\n        Loop 10 {\n            try {\n                sh := ComObject(\"Shell.Application\")\n                for window in sh.Windows {\n                    try {\n                        if (window.hwnd == hNewWnd) {\n                            newPath := window.Document.Folder.Self.Path\n                            break\n                        }\n                    }\n                }\n            }\n            if (newPath != \"\")\n                break\n            Sleep(100) ; Wait 100ms before retrying\n        }\n\n\n        if (newPath != \"\") {\n             ; Filter out \"My PC\" or empty paths if they accidentally slipped through \n             ; (My PC CLSID is ::{20D04FE0-3AEA-1069-A2D8-08002B30309D})\n             if (newPath ~= \"i)^::{\") {\n                  return ; Do not merge special shell folders like My PC\n             }\n\n\n            try {\n                ; Close the newly created window immediately\n                WinClose(hNewWnd)\n                \n                ; Activate the target window\n                WinActivate(targetWnd)\n                WinWaitActive(targetWnd,, 2)\n\n\n                ; Check if the path is already open in the target window\n                pathAlreadyOpen := false\n                sh := ComObject(\"Shell.Application\")\n                openPaths := []\n                for window in sh.Windows {\n                    try {\n                        ; Check if this tab belongs to our target window\n                        ; Note: grabbing the HWND of a tab is tricky, but often they share the main window HWND or parent\n                        ; We'll assume if it's in the collection, it's open somewhere. \n                        ; We strictly want to avoid opening duplicates in the SAME window if possible.\n                        if (window.Document.Folder.Self.Path = newPath) {\n                            pathAlreadyOpen := true\n                            break\n                        }\n                    }\n                }\n\n\n                if (pathAlreadyOpen) {\n                    ; Attempt to switch to the existing tab\n                    ; Since there is no direct \"Activate Tab\" API, we cycle Ctrl+Tab until the Window Title matches the folder name\n                    SplitPath(newPath, &folderName)\n                    Loop 20 { ; Max attempts\n                        currentTitle := WinGetTitle(targetWnd)\n                        if (InStr(currentTitle, folderName)) {\n                            break ; Found it (probably)\n                        }\n                        Send(\"^{Tab}\")\n                        Sleep(50)\n                    }\n                } else {\n                    ; Create new tab\n                    Send(\"^t\") ; Open new tab\n                    Sleep(150) ; Slight delay for tab animation\n                    Send(\"!d\") ; Focus address bar\n                    Sleep(50)\n                    SendText(newPath)\n                    Sleep(50)\n                    Send(\"{Enter}\")\n                }\n            }\n        }\n    }\n}",
            "enabled": true
        }
    ],
    "context_shortcuts": [
        {
            "name": "Gemini Save Chat",
            "category": "Terminal",
            "description": "Save current Gemini chat session",
            "hotkey": "^s",
            "window_title": "Ready",
            "process_name": "WindowsTerminal.exe",
            "window_class": "",
            "action": "SendText(\"/chat save \")",
            "enabled": true
        },
        {
            "name": "Gemini Resume Chat",
            "category": "Terminal",
            "description": "Resume previous Gemini chat session",
            "hotkey": "^r",
            "window_title": "Ready",
            "process_name": "WindowsTerminal.exe",
            "window_class": "",
            "action": "SendText(\"/chat resume \")",
            "enabled": true
        },
        {
            "name": "Gemini Session",
            "category": "Terminal",
            "description": "Save current Gemini chat session",
            "hotkey": "^/",
            "window_title": "Ready",
            "process_name": "WindowsTerminal.exe",
            "window_class": "",
            "action": "SendText(\"/stats session\")",
            "enabled": true
        }
    ]
}