{
    "script_shortcuts": [
        {
            "name": "Open Terminal Admin",
            "description": "Opens PowerShell as administrator",
            "hotkey": "!x",
            "action": "RunWait(\"pwsh -Command `\"cd $env:USERPROFILE; Start-Process pwsh -Verb RunAs`\"\", , \"Hide\")",
            "category": "Script",
            "enabled": false
        },
        {
            "name": "Run Python Script",
            "description": "Opens run.py in the ms1 directory",
            "hotkey": "ScrollLock",
            "action": "run_py_script()\nrun_py_script()\n{\n    Run(\"C:\\Users\\nahid\\ms\\ms1\\scripts\\run\\Run.py\", , \"Show\")\n    ; Wait a moment for the window to appear\n    Sleep(1000)\n    ; Make the window always on top (assumes it's the active window)\n    ;WinSetAlwaysOnTop(true, \"A\")\n}",
            "category": "Launch",
            "enabled": true
        },
        {
            "name": "Monitor Internal",
            "description": "Switch to internal monitor only",
            "hotkey": "RAlt & Numpad1",
            "action": "Run(\"C:\\Users\\nahid\\ms\\msBackups\\Display\\DisplaySwitch.exe /internal\", \"\", \"Hide\")",
            "category": "Launch"
        },
        {
            "name": "Monitor External",
            "description": "Switch to external monitor only",
            "hotkey": "RAlt & Numpad2",
            "action": "Run(\"C:\\Users\\nahid\\ms\\msBackups\\Display\\DisplaySwitch.exe /external\", \"\", \"Hide\")",
            "category": "Launch"
        },
        {
            "name": "Monitor Extend",
            "description": "Extend display to both monitors",
            "hotkey": "RAlt & Numpad3",
            "action": "Run(\"C:\\Users\\nahid\\ms\\msBackups\\Display\\DisplaySwitch.exe /extend\", \"\", \"Hide\")",
            "category": "Launch"
        },
        {
            "name": "Bio GUI",
            "description": "Opens Bio.ahk GUI",
            "hotkey": "!b",
            "action": "Run(\"C:\\Users\\nahid\\ms\\ms1\\scripts\\Autohtokey\\version2\\gui\\Bio.ahk\", \"\", \"Hide\")",
            "category": "Launch",
            "enabled": true
        },
        {
            "name": "Ultimate GUI",
            "description": "Opens Ultimate_Gui.py",
            "hotkey": "!u",
            "action": "Run(\"C:\\Users\\nahid\\ms\\ms1\\Ultimate_Gui.py\", \"\", \"Hide\")",
            "category": "Launch"
        },
        {
            "name": "Always On Top Toggle",
            "description": "Toggles always on top for active window",
            "hotkey": "#t",
            "action": "Always_on_Top()\nAlways_on_Top(){\n    static alwaysOnTop := false\n    if (alwaysOnTop) {\n        WinSetAlwaysOnTop(false, \"A\")\n    } else {\n        WinSetAlwaysOnTop(true, \"A\")\n    }\n    alwaysOnTop := !alwaysOnTop\n}",
            "category": "Script"
        },
        {
            "name": "Kill Foreground Process",
            "description": "Forcefully kills the process under mouse cursor",
            "hotkey": "!q",
            "action": "KillForeground() {\n    MouseGetPos(, , &WinID)\n    ProcessID := WinGetPID(\"ahk_id \" WinID)\n    Run(\"taskkill /f /pid \" ProcessID, , \"Hide\")\n}",
            "category": "Script",
            "enabled": true
        },
        {
            "name": "Copy Path",
            "description": "",
            "hotkey": "^!m",
            "action": "CopyPath_File()\nCopyPath_File() {\n    ClipboardBackup := ClipboardAll()\n    A_Clipboard := \"\" \n    Send(\"^c\")\n    Errorlevel := !ClipWait(1)\n    if ErrorLevel\n    {\n    MsgBox(\"No valid file path found.\")\n    }\n    else\n    {\n    ClipBoardContent := A_Clipboard\n    ; V1toV2: StrReplace() is not case sensitive\n    ; check for StringCaseSense in v1 source script\n    ; and change the CaseSense param in StrReplace() if necessary\n    ClipBoardContent := StrReplace(ClipBoardContent, \"`n\", \"`t\")\n    A_Clipboard := ClipboardBackup\n    A_Clipboard := ClipBoardContent\n    TrayTip(\"Copy as Path\", \"Copied `\"\" ClipBoardContent \"`\" to clipboard.\")\n    }}",
            "category": "Script"
        },
        {
            "name": "Kill (dnplayer/python/) + Change Display",
            "category": "Script",
            "description": "",
            "hotkey": "^!+r",
            "action": "{\n    ; Kill dnplayer.exe\n    Run(\"taskkill /F /IM dnplayer.exe\",,\"Hide\")\n    ; Kill python.exe\n    Run(\"taskkill /F /IM python.exe\",,\"Hide\")\n    ; Run the command\n    Run(\"C:\\Users\\nahid\\ms\\msBackups\\Display\\DisplaySwitch.exe /internal\",,\"Hide\")\n}"
        },
        {
            "name": "mypygui",
            "category": "Launch",
            "description": "",
            "hotkey": "#x",
            "action": "Run(\"C:\\Users\\nahid\\ms\\ms1\\Testing\\mypygui\\script_manager_gui.py\", , \"Hide\")",
            "enabled": true
        },
        {
            "name": "Startup Setup",
            "category": "Launch",
            "description": "",
            "hotkey": "#s",
            "action": "Run(\"C:\\Users\\nahid\\ms\\ms1\\scripts\\flask\\4999_startup\\startup.py\", , \"Hide\")"
        },
        {
            "name": "CrossHair",
            "category": "General",
            "description": "",
            "hotkey": "^+m",
            "action": "Run(\"C:\\Users\\nahid\\ms\\ms1\\scripts\\xy\\XY_CroosHair.py\", , \"Hide\")"
        },
        {
            "name": "Explorer Restart",
            "category": "Script",
            "description": "",
            "hotkey": "LAlt & e",
            "action": "Run('pwsh -c explorer.exe', , 'Hide')"
        },
        {
            "name": "Replace Space with _",
            "category": "Text",
            "description": "",
            "hotkey": "RAlt & Space",
            "action": "replacewith_()\nreplacewith_()\n{\n    ; Backup the clipboard\n    ClipboardBackup := ClipboardAll()\n    ; Clear the clipboard\n    A_Clipboard := \"\"\n    ; Copy the selected text\n    Send(\"^c\")\n    ; Wait for the clipboard to contain the copied text\n    if !ClipWait(1) {\n        MsgBox(\"No text selected or copying failed.\")\n    } else {\n        ; Get the clipboard content\n        ClipboardContent := A_Clipboard\n        ; Replace all spaces with underscores\n        ClipboardContent := StrReplace(ClipboardContent, A_Space, \"_\")\n        ; Put the modified text back in clipboard\n        A_Clipboard := ClipboardContent\n        ; Paste the modified text (this replaces the selected text)\n        Send(\"^v\")\n        ; Wait a moment for the paste to complete\n        Sleep(50)\n    }\n    ; Restore the original clipboard content\n    A_Clipboard := ClipboardBackup\n}"
        },
        {
            "name": "Replace - w Space",
            "category": "Text",
            "description": "",
            "hotkey": "RAlt & -",
            "action": "replacedashwithspace()\nreplacedashwithspace()\n{\n    ; Backup the clipboard\n    ClipboardBackup := ClipboardAll()\n    ; Clear the clipboard\n    A_Clipboard := \"\"\n    ; Copy the selected text\n    Send(\"^c\")\n    ; Wait for the clipboard to contain the copied text\n    if !ClipWait(1) {\n        MsgBox(\"No text selected or copying failed.\")\n    } else {\n        ; Get the clipboard content\n        ClipboardContent := A_Clipboard\n        ; Replace all dashes with spaces\n        ClipboardContent := StrReplace(ClipboardContent, \"-\", A_Space)\n        ; Put the modified text back in clipboard\n        A_Clipboard := ClipboardContent\n        ; Paste the modified text (this replaces the selected text)\n        Send(\"^v\")\n        ; Wait a moment for the paste to complete\n        Sleep(50)\n    }\n    ; Restore the original clipboard content\n    A_Clipboard := ClipboardBackup\n}"
        },
        {
            "name": "Send Apps to 2nd Display",
            "category": "Display",
            "description": "",
            "hotkey": "!1",
            "action": "Run(\"C:\\Users\\nahid\\ms\\ms1\\scripts\\Autohtokey\\version2\\display\\send_to_2nd.ahk\", \"\", \"Hide\")",
            "enabled": true
        },
        {
            "name": "Open w VScode",
            "category": "General",
            "description": "",
            "hotkey": "^!n",
            "action": "Run(\"C:\\Users\\nahid\\ms\\ms1\\scripts\\Autohtokey\\version1\\nvim_OpenWith.ahk\", \"\", \"Show\")",
            "enabled": false
        },
        {
            "name": "Center Apps Window",
            "category": "Display",
            "description": "",
            "hotkey": "LAlt & c",
            "action": "Center_Focused_Window()\nCenter_Focused_Window() {\n    ; Get the handle of the active (focused) window\n    hwnd := WinGetID(\"A\")\n    ; Get the position and size of the active window\n    WinGetPos(&x, &y, &w, &h, \"ahk_id \" hwnd)\n    ; Get the screen width and height\n    ScreenWidth := SysGet(78)\n    ScreenHeight := SysGet(79)\n    ; Calculate new position to center the window\n    newX := (ScreenWidth - w) / 2\n    newY := (ScreenHeight - h) / 2\n    ; Move the window to the calculated position\n    WinMove(newX, newY, , , \"ahk_id \" hwnd)\n}"
        },
        {
            "name": "Black Screen",
            "category": "Display",
            "description": "",
            "hotkey": "^!b",
            "action": "Toggle_Screen_Blackout() {\n    static blackoutState := 0\n    static myGui := \"\"\n    \n    if (blackoutState = 0) {\n        blackoutState := 1\n        myGui := Gui()\n        myGui.Opt(\"+LastFound +AlwaysOnTop -Caption +ToolWindow\")\n        myGui.BackColor := \"Black\"\n        myGui.Show(\"w\" . A_ScreenWidth . \" h\" . A_ScreenHeight . \" x0 y0 NoActivate\")\n    } else {\n        blackoutState := 0\n        myGui.Destroy()\n        myGui := \"\"\n    }\n}"
        },
        {
            "name": "White Screen",
            "category": "Display",
            "description": "",
            "hotkey": "^!w",
            "action": "Toggle_Screen_Whiteout() {\n    static whiteState := 0\n    static myGui := \"\"\n    \n    if (whiteState = 0) {\n        whiteState := 1\n        myGui := Gui()\n        myGui.Opt(\"+LastFound +AlwaysOnTop -Caption +ToolWindow\")\n        myGui.BackColor := \"ffffff\"\n        myGui.Show(\"w\" . A_ScreenWidth . \" h\" . A_ScreenHeight . \" x0 y0 NoActivate\")\n    } else {\n        whiteState := 0\n        myGui.Destroy()\n        myGui := \"\"\n    }\n}"
        },
        {
            "name": "Execute Script W/O Closing",
            "category": "General",
            "description": "",
            "hotkey": "^!+Enter",
            "action": "{\n    ClipSaved := ClipboardAll()\n    A_Clipboard := \"\"               ; Clear clipboard\n    ; Get the active window title\n    ActiveTitle := WinGetTitle(\"A\")\n    ; If the active window is VSCode, simulate the shortcut to copy the file path\n    if InStr(ActiveTitle, \"Visual Studio Code\") {\n        ; Simulate VSCode's shortcut to copy the current file path (Shift + Alt + C)\n        Send(\"+!c\")\n        Errorlevel := !ClipWait(1)               ; Wait until clipboard has content\n    } else {\n        ; Send Ctrl+C to copy the selected file path in other environments\n        Send(\"^c\")\n        Errorlevel := !ClipWait(1)               ; Wait until clipboard has content\n    }\n    if (A_Clipboard != \"\") {\n        ; Get the selected file path from the clipboard\n        FilePath := A_Clipboard\n        Ext := SubStr(FilePath, (InStr(FilePath, \".\", 0, -1) + 1)<1 ? (InStr(FilePath, \".\", 0, -1) + 1)-1 : (InStr(FilePath, \".\", 0, -1) + 1))\n        ; Check the extension and run the appropriate command\n        if (Ext = \"py\") {\n            Run(\"cmd /k python `\"\" FilePath \"`\"\", , , &PID)\n        } else if (Ext = \"ps1\") {\n            Run(\"cmd /k powershell -ExecutionPolicy Bypass -File `\"\" FilePath \"`\"\", , , &PID)\n        } else if (Ext = \"bat\") {\n            Run(\"cmd /k `\"\" FilePath \"`\"\", , , &PID)\n        } else if (Ext = \"ahk\") {\n            Run(\"cmd /k `\"\" FilePath \"`\"\", , , &PID)\n        } else {\n            MsgBox(\"Unsupported file type: \" Ext)\n        }\n    } else {\n        MsgBox(\"No file path selected or copied.\")\n    }\n    ; Restore original clipboard content\n    A_Clipboard := ClipSaved\n    return\n}"
        },
        {
            "name": "Border",
            "category": "Text",
            "description": "",
            "hotkey": "^+b",
            "action": "AddSmartBorder()\nAddSmartBorder()\n{\n    ; Copy selected text\n    A_Clipboard := \"\"\n    Send(\"^c\")\n    ClipWait(1)\n    if !A_Clipboard {\n        MsgBox \"Nothing selected!\"\n        return\n    }\n    \n    ; Detect language/file type from window title\n    activeTitle := WinGetTitle(\"A\")\n    commentStyle := DetectCommentStyle(activeTitle)\n    \n    ; Split into lines and normalize tabs → spaces\n    rawLines := StrSplit(A_Clipboard, \"`n\", \"`r\")\n    maxLen := 0\n    for i, line in rawLines {\n        clean := StrReplace(line, \"`t\", \"    \")\n        rawLines[i] := clean\n        if (StrLen(clean) > maxLen)\n            maxLen := StrLen(clean)\n    }\n    \n    ; Build borders (only borders are commented, content stays as-is)\n    borderChar := commentStyle.border\n    topBorder := commentStyle.prefix . \" \" . StrRepeat(borderChar, maxLen + 3)\n    bottomBorder := topBorder\n    \n    ; Assemble output: commented borders + content with commented side borders\n    output := topBorder . \"`r`n\"\n    for line in rawLines {\n        ; Calculate padding to align vertical border with horizontal border end\n        padding := StrRepeat(\" \", maxLen + 4 - StrLen(line))\n        output .= line . padding . commentStyle.prefix . \"`r`n\"\n    }\n    output .= bottomBorder\n    \n    ; Replace selection with bordered text\n    A_Clipboard := output\n    Sleep 50\n    Send(\"^v\")\n}\n\nDetectCommentStyle(windowTitle) {\n    ; Convert to lowercase for easier matching\n    title := StrLower(windowTitle)\n    \n    ; Detect based on file extension or application\n    if (InStr(title, \".py\") || InStr(title, \"python\") || InStr(title, \"pycharm\")) {\n        return {type: \"line\", prefix: \"#\", border: \"#\"}\n    } else if (InStr(title, \".ps1\") || InStr(title, \"powershell\") || InStr(title, \"ise\")) {\n        return {type: \"line\", prefix: \"#\", border: \"#\"}\n    } else if (InStr(title, \".css\")) {\n        return {type: \"line\", prefix: \"/*\", border: \"*\"}\n    } else if (InStr(title, \".js\") || InStr(title, \".ts\") || InStr(title, \".java\") || InStr(title, \".c\") || InStr(title, \".cpp\")) {\n        return {type: \"line\", prefix: \"//\", border: \"/\"}\n    } else if (InStr(title, \".ahk\") || InStr(title, \"autohotkey\")) {\n        return {type: \"line\", prefix: \";\", border: \"#\"}\n    } else if (InStr(title, \".bat\") || InStr(title, \".cmd\")) {\n        return {type: \"line\", prefix: \"REM\", border: \"=\"}\n    } else {\n        ; Default fallback\n        return {type: \"line\", prefix: \"#\", border: \"#\"}\n    }\n}\n\nStrRepeat(char, count) {\n    result := \"\"\n    Loop count\n        result .= char\n    return result\n}"
        },
        {
            "name": "Merge all window in a single explorer",
            "category": "General",
            "description": "",
            "hotkey": "#e",
            "action": "MergeAllExplorerWindows()\n\nMergeAllExplorerWindows() {\n    ; Get the target window to merge everything into\n    mainWindow := WinActive(\"ahk_class CabinetWClass\")\n    if (!mainWindow)\n        mainWindow := WinExist(\"ahk_class CabinetWClass\")\n    \n    if (!mainWindow) {\n        Run(\"explorer.exe\")\n        return\n    }\n\n    pathsToOpen := []\n    sourceHwnds := Map()\n\n    ; Collect all paths from all explorer tabs\n    shellApp := ComObject(\"Shell.Application\")\n    \n    for window in shellApp.Windows {\n        try {\n            if (window.Name != \"Windows Explorer\" && window.Name != \"File Explorer\")\n                continue\n                \n            thisHwnd := 0\n            try {\n                thisHwnd := window.HWND\n            } catch {\n                continue\n            }\n            \n            if (!thisHwnd || thisHwnd == 0)\n                continue\n\n            if (thisHwnd != mainWindow) {\n                path := \"\"\n                try {\n                    path := window.Document.Folder.Self.Path\n                } catch {\n                    try {\n                        path := window.LocationURL\n                    } catch {\n                        path := window.LocationName\n                    }\n                }\n                \n                if (path != \"\" && path != \"This PC\") {\n                    pathsToOpen.Push(path)\n                    sourceHwnds[thisHwnd] := true\n                }\n            }\n        } catch {\n            continue\n        }\n    }\n\n    if (pathsToOpen.Length == 0 && sourceHwnds.Count == 0) {\n        return\n    }\n\n    ; Backup clipboard\n    clipSaved := ClipboardAll()\n\n    WinActivate(\"ahk_id \" . mainWindow)\n    if (!WinWaitActive(\"ahk_id \" . mainWindow, , 2)) {\n        A_Clipboard := clipSaved\n        return\n    }\n\n    ; --- DELIBERATE AND STABLE NAVIGATION ---\n    for p in pathsToOpen {\n        cleanPath := p\n        \n        if InStr(cleanPath, \"file:///\") {\n            cleanPath := StrReplace(cleanPath, \"file:///\", \"\")\n            cleanPath := StrReplace(cleanPath, \"/\", \"\\\")\n            cleanPath := StrReplace(cleanPath, \"%20\", \" \")\n        }\n        \n        ; 1. Create a new tab and wait for animation to complete\n        Send(\"^t\")\n        Sleep(800) ; Increased for stability\n        \n        ; 2. Focus address bar\n        Send(\"^l\")\n        Sleep(400)\n        \n        ; 3. Clear existing text just in case\n        Send(\"^a\") ; Select all\n        Sleep(100)\n        Send(\"{BackSpace}\")\n        Sleep(200)\n        \n        ; 4. Update clipboard and PASTE\n        A_Clipboard := cleanPath\n        Sleep(200) ; Give OS time to register clipboard change\n        Send(\"^v\")\n        Sleep(400) ; Crucial: Wait for the text to actually appear in the box\n        \n        ; 5. Navigation\n        Send(\"{Enter}\")\n        Sleep(1000) ; Wait for navigation to commit before moving to the next tab\n    }\n\n    ; Restore original clipboard\n    A_Clipboard := clipSaved\n\n    ; Close other windows\n    for hwnd, _ in sourceHwnds {\n        try {\n            if WinExist(\"ahk_id \" . hwnd) {\n                WinClose(\"ahk_id \" . hwnd)\n                if (WinExist(\"ahk_id \" . hwnd)) {\n                    Sleep(500)\n                    WinKill(\"ahk_id \" . hwnd)\n                }\n            }\n        }\n    }\n\n    WinActivate(\"ahk_id \" . mainWindow)\n}",
            "enabled": true
        },
        {
            "name": "autofill job field",
            "category": "General",
            "description": "",
            "hotkey": "!n",
            "action": "Run(\"C:\\Users\\nahid\\ms\\msBackups\\@JOB\\autofill.ahk\", \"\", \"Hide\")",
            "enabled": false
        },
        {
            "name": "Open With Preferred Editor",
            "category": "General",
            "description": "",
            "hotkey": "^!n",
            "action": "OpenWithEditor()\nOpenWithEditor() {\n    ; Backup current clipboard content\n    ClipboardBackup := ClipboardAll()\n    \n    ; Clear clipboard and copy the selected file path\n    A_Clipboard := \"\"\n    Send(\"^c\")\n    \n    if !ClipWait(1) {\n        MsgBox(\"No valid file path found.\")\n        A_Clipboard := ClipboardBackup\n        return\n    }\n    \n    ClipBoardContent := A_Clipboard\n    \n    if InStr(ClipBoardContent, \"\\\") {\n        ; Handle multiple files (split by newline)\n        FilePaths := \"\"\n        Loop Parse, ClipBoardContent, \"`n\", \"`r\"\n        {\n            if (A_LoopField != \"\")\n            {\n                FilePaths .= '\"' . A_LoopField . '\" '\n            }\n        }\n        \n        if (FilePaths != \"\") {\n            ; Call editor_chooser.py with all file paths\n            Run('python \"C:\\Users\\nahid\\ms\\ms1\\scripts\\run\\editor_chooser.py\" ' . FilePaths)\n        }\n    } else {\n        MsgBox(\"No valid file path found.\")\n    }\n    \n    ; Restore original clipboard content\n    A_Clipboard := ClipboardBackup\n}",
            "enabled": true
        },
        {
            "name": "komorebi stop/start",
            "category": "General",
            "description": "",
            "hotkey": "^+k",
            "action": "komo_start_stop()\nkomo_start_stop() {\nRunWait \"powershell.exe -Command Stop-Process -Name komorebi -ErrorAction SilentlyContinue\", , \"Hide\"\nRun \"komorebic.exe start\", , \"Hide\"\n}",
            "enabled": true
        },
        {
            "name": "Quick Shortcut",
            "category": "Text",
            "description": "Sleep 250 //    Send \" -> \"",
            "hotkey": "^q",
            "action": "KeySequence()\nKeySequence() {\n    Send \"^!{Numpad2}\"\n    Sleep 250\n    Send \"{Enter}\"\n    Sleep 250\n    Send \"^!{Numpad1}\"\n}",
            "enabled": true
        },
        {
            "name": "Take Screenshot",
            "category": "General",
            "description": "",
            "hotkey": "PrintScreen",
            "action": "Run(\"C:\\Users\\nahid\\ms\\ms1\\Testing\\screenshot\\region_screenshot.py\", \"\", \"Hide\")",
            "enabled": true
        },
        {
            "name": "Open Folder gui",
            "category": "General",
            "description": "",
            "hotkey": "#f",
            "action": "Run(\"C:\\Users\\nahid\\ms\\ms1\\Testing\\screenshot\\folder_launcher\\launcher.py\", \"\", \"Hide\")",
            "enabled": true
        },
        {
            "name": "Gallery View",
            "category": "General",
            "description": "",
            "hotkey": "#v",
            "action": "Run(\"C:\\Users\\nahid\\ms\\ms1\\Testing\\screenshot\\gallery\\gallery.py\", \"\", \"Hide\")",
            "enabled": true
        },
        {
            "name": "DropClipboard Insert To Field",
            "category": "General",
            "description": "",
            "hotkey": "^+i",
            "action": "DropClipboard()\nDropClipboard() {\n    ; 1. Get current text from clipboard\n    clipText := A_Clipboard\n    if (clipText == \"\") {\n        ShowNotification(\"Clipboard is empty!\", \"Warning\")\n        return\n    }\n\n\n    ; 2. Create a temporary folder and file\n    tempDir := A_Temp \"\\AutoInsert\"\n    if !DirExist(tempDir)\n        DirCreate(tempDir)\n    \n    ; Create a unique filename using timestamp\n    fileName := \"clip_\" A_Now \"_\" A_TickCount \".txt\"\n    filePath := tempDir \"\\\" fileName\n    \n    try {\n        ; Write clipboard content to the new file with UTF-8 encoding (supports Bangla, etc.)\n        if FileExist(filePath)\n            FileDelete(filePath)\n        ; \"UTF-8\" includes the BOM (Byte Order Mark), which helps Windows apps recognize the text as Unicode.\n        FileAppend(clipText, filePath, \"UTF-8\")\n    } catch Error as err {\n        MsgBox(\"Failed to create temporary file:`n\" err.Message)\n        return\n    }\n\n\n    ; 3. Prepare the Clipboard for \"Smart Drop\"\n    ; We set both File (CF_HDROP) and Text (CF_UNICODETEXT) formats.\n    ; This allows Windows to decide: if it's a folder, drop the file; if it's a text field, paste the path.\n    if !SetClipboardSmart(filePath) {\n        MsgBox(\"Failed to set clipboard data.\")\n        return\n    }\n\n\n    ; 4. Perform the \"Drop\" action\n    ; Get window and position under mouse\n    MouseGetPos(&mX, &mY, &hWnd)\n    \n    ; Optional: Activate the window to ensure it receives the focus/paste\n    try {\n        WinActivate(\"ahk_id \" hWnd)\n    }\n    \n    ; Small click to focus the exact element under the mouse\n    Click(mX, mY)\n    Sleep(100) ; Wait for focus to settle\n    \n    ; Send Paste command\n    Send(\"^v\")\n\n\n    ShowNotification(\"Dropped: \" fileName \"`n(File & Path ready)\", \"Success\")\n}\n\n\n; --- Helper Functions ---\n\n\n/**\n * Sets the clipboard to contain both the file object (for dropping into folders/apps)\n * and the file path string (for pasting into text fields).\n */\nSetClipboardSmart(filePath) {\n    if !DllCall(\"OpenClipboard\", \"ptr\", A_ScriptHwnd)\n        return false\n    \n    DllCall(\"EmptyClipboard\")\n\n\n    ; -- 1. Set CF_UNICODETEXT (Pasting path into text fields) --\n    hText := DllCall(\"GlobalAlloc\", \"uint\", 0x42, \"ptr\", (StrLen(filePath) + 1) * 2, \"ptr\")\n    pText := DllCall(\"GlobalLock\", \"ptr\", hText, \"ptr\")\n    StrPut(filePath, pText, \"UTF-16\")\n    DllCall(\"GlobalUnlock\", \"ptr\", hText)\n    DllCall(\"SetClipboardData\", \"uint\", 13, \"ptr\", hText) ; 13 = CF_UNICODETEXT\n\n\n    ; -- 2. Set CF_HDROP (Dropping file into folders/browser uploads) --\n    ; DROPFILES structure is 20 bytes\n    charCount := StrLen(filePath) + 2 ; +1 for null, +1 for double null (required for file lists)\n    hDrop := DllCall(\"GlobalAlloc\", \"uint\", 0x42, \"ptr\", 20 + (charCount * 2), \"ptr\")\n    pDrop := DllCall(\"GlobalLock\", \"ptr\", hDrop, \"ptr\")\n    \n    NumPut(\"uint\", 20, pDrop, 0)   ; pFiles: offset to file list\n    NumPut(\"uint\", 1, pDrop, 16)  ; fWide: 1 means Unicode\n    \n    ; Copy path to the offset 20\n    StrPut(filePath, pDrop + 20, \"UTF-16\")\n    ; Double null termination (already handled by GlobalAlloc zero-init, but for safety:)\n    NumPut(\"ushort\", 0, pDrop + 20 + (StrLen(filePath) * 2), 0)\n    \n    DllCall(\"GlobalUnlock\", \"ptr\", hDrop)\n    DllCall(\"SetClipboardData\", \"uint\", 15, \"ptr\", hDrop) ; 15 = CF_HDROP\n\n\n    DllCall(\"CloseClipboard\")\n    return true\n}\n\n\nShowNotification(msg, title := \"\") {\n    ToolTip(title ? title \": \" msg : msg)\n    SetTimer(() => ToolTip(), -2500)\n}",
            "enabled": true
        },
        {
            "name": "Go To SleepMode",
            "category": "General",
            "description": "",
            "hotkey": "#l",
            "action": "GoToSleep() {\n    ; 0 = Standby (Sleep), 1 = Hibernate\n    DllCall(\"PowrProf\\SetSuspendState\", \"Int\", 0, \"Int\", 0, \"Int\", 0)\n}",
            "enabled": true
        }
    ],
    "text_shortcuts": [
        {
            "name": "AutoHotkey Version 1",
            "description": "Inserts AHK v1 header requirement",
            "trigger": ";v1",
            "replacement": "#Requires AutoHotkey v1.0",
            "category": "AHK",
            "enabled": true
        },
        {
            "name": "AutoHotkey Version 2",
            "description": "Inserts AHK v2 header requirement",
            "trigger": ";v2",
            "replacement": "{#}Requires AutoHotkey v2.0",
            "category": "AHK",
            "enabled": true
        },
        {
            "name": "Registry Run Path",
            "description": "Windows startup registry path run",
            "trigger": ";run",
            "replacement": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
            "category": "Path"
        },
        {
            "name": "PowerShell Symlink",
            "description": "PowerShell command to create symbolic link",
            "trigger": ";mklink",
            "replacement": "New-Item -ItemType SymbolicLink -Path \"Fake\" -Target \"Original\" -Force",
            "category": "Shell"
        },
        {
            "name": "Symbols",
            "description": "  󰩷  󰣉  󰁄 󰁌 󰞘 󰜴 󱞩 󱞫 󰤼",
            "trigger": ";--",
            "replacement": "",
            "category": "Icon/Emoji/Sign"
        },
        {
            "name": "Star",
            "category": "Icon/Emoji/Sign",
            "description": "",
            "trigger": ";star",
            "replacement": ""
        },
        {
            "name": "Db path",
            "category": "Path",
            "description": "",
            "trigger": ";db",
            "replacement": "C:\\Users\\nahid\\ms\\db"
        },
        {
            "name": "Changes for Ai to know that i made on my files",
            "category": "General",
            "description": "",
            "trigger": ";change",
            "replacement": "ok i have made some changes from last time  so keep that in mind now",
            "enabled": true
        },
        {
            "name": "Percentage %",
            "category": "Text",
            "description": "",
            "trigger": ";%",
            "replacement": "℅",
            "enabled": true
        },
        {
            "name": "not equal",
            "category": "Math Sign",
            "description": "",
            "trigger": ";notequal",
            "replacement": "≠",
            "enabled": true
        },
        {
            "name": "Theta Sign",
            "category": "Math Sign",
            "description": "",
            "trigger": ";theta",
            "replacement": "θ",
            "enabled": true
        }
    ],
    "startup_scripts": [
        {
            "name": "Explorer Tabs Hook",
            "category": "General",
            "description": "",
            "action": ";! Explorer Tabs Hook\n; Register the shell hook to listen for window creation\nDllCall(\"RegisterShellHookWindow\", \"Ptr\", A_ScriptHwnd)\nmsgNum := DllCall(\"RegisterWindowMessage\", \"Str\", \"SHELLHOOK\")\nOnMessage(msgNum, ShellMessage)\n\n\nShellMessage(wParam, lParam, *) {\n    if (wParam == 1) { ; HSHELL_WINDOWCREATED\n        try {\n            if (WinGetClass(lParam) == \"CabinetWClass\") {\n                ; Found a new Explorer window, wait briefly to let it initialize and then process\n                SetTimer(MergeTab.Bind(lParam), -100)\n            }\n        }\n    }\n}\n\n\nMergeTab(hNewWnd) {\n    ; Wait for the window to actually exist\n    if !WinExist(hNewWnd)\n        return\n\n\n    ; Get list of all Explorer windows\n    allExplorers := WinGetList(\"ahk_class CabinetWClass\")\n    targetWnd := 0\n    \n    ; Find an existing explorer window that isn't the new one\n    for hWnd in allExplorers {\n        if (hWnd != hNewWnd) {\n            targetWnd := hWnd\n            break\n        }\n    }\n\n\n    if (targetWnd) {\n        newPath := \"\"\n        \n        ; Retry loop to get the path (sometimes COM object is slow to update)\n        Loop 10 {\n            try {\n                sh := ComObject(\"Shell.Application\")\n                for window in sh.Windows {\n                    try {\n                        if (window.hwnd == hNewWnd) {\n                            newPath := window.Document.Folder.Self.Path\n                            break\n                        }\n                    }\n                }\n            }\n            if (newPath != \"\")\n                break\n            Sleep(100) ; Wait 100ms before retrying\n        }\n\n\n        if (newPath != \"\") {\n             ; Filter out \"My PC\" or empty paths if they accidentally slipped through \n             ; (My PC CLSID is ::{20D04FE0-3AEA-1069-A2D8-08002B30309D})\n             if (newPath ~= \"i)^::{\") {\n                  return ; Do not merge special shell folders like My PC\n             }\n\n\n            try {\n                ; Close the newly created window immediately\n                WinClose(hNewWnd)\n                \n                ; Activate the target window\n                WinActivate(targetWnd)\n                WinWaitActive(targetWnd,, 2)\n\n\n                ; Check if the path is already open in the target window\n                pathAlreadyOpen := false\n                sh := ComObject(\"Shell.Application\")\n                openPaths := []\n                for window in sh.Windows {\n                    try {\n                        ; Check if this tab belongs to our target window\n                        ; Note: grabbing the HWND of a tab is tricky, but often they share the main window HWND or parent\n                        ; We'll assume if it's in the collection, it's open somewhere. \n                        ; We strictly want to avoid opening duplicates in the SAME window if possible.\n                        if (window.Document.Folder.Self.Path = newPath) {\n                            pathAlreadyOpen := true\n                            break\n                        }\n                    }\n                }\n\n\n                if (pathAlreadyOpen) {\n                    ; Attempt to switch to the existing tab\n                    ; Since there is no direct \"Activate Tab\" API, we cycle Ctrl+Tab until the Window Title matches the folder name\n                    SplitPath(newPath, &folderName)\n                    Loop 20 { ; Max attempts\n                        currentTitle := WinGetTitle(targetWnd)\n                        if (InStr(currentTitle, folderName)) {\n                            break ; Found it (probably)\n                        }\n                        Send(\"^{Tab}\")\n                        Sleep(50)\n                    }\n                } else {\n                    ; Create new tab\n                    Send(\"^t\") ; Open new tab\n                    Sleep(150) ; Slight delay for tab animation\n                    Send(\"!d\") ; Focus address bar\n                    Sleep(50)\n                    SendText(newPath)\n                    Sleep(50)\n                    Send(\"{Enter}\")\n                }\n            }\n        }\n    }\n}",
            "enabled": false
        }
    ]
}