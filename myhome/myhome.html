<!DOCTYPE html>
<html>
<head>
  <title>Home</title>
  <link rel="shortcut icon" href="https://cdn-icons-png.flaticon.com/512/4021/4021539.png" type="image/x-icon">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
/* Import the JetBrains Mono font */
@import url("https://www.nerdfonts.com/assets/css/webfont.css");

/* Thin scrollbar with custom styles for html and body */
* {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
  min-height: 100vh;
  margin: 0;
  background-color: #31343a;
  font-family: Calibri;
  scrollbar-width: thin;
  scrollbar-color: #ff0000 #000000;
  /* black background and red thumb */
}

/* WebKit browsers (Chrome, Safari) */
html::-webkit-scrollbar,
body::-webkit-scrollbar {
  width: 1px;
  /* Set the width of the scrollbar */
}

html::-webkit-scrollbar-thumb,
body::-webkit-scrollbar-thumb {
  background-color: #ff000f;
  /* Color of the thumb (red) */
}

html::-webkit-scrollbar-track,
body::-webkit-scrollbar-track {
  background-color: #000000;
  /* Color of the track (black) */
}

/* For html part 2 ############################################################*/
.flex-container2 {
  display: flex;
  flex-direction: row;
  background-color: #31343a;
  gap: 3px;
  flex-wrap: wrap;
  text-align: left;
  line-height: auto;
  align-items: flex-start;
  font-size: auto;
  color: rgb(255, 255, 255);
  padding: 1cm;
  border-radius: 1cm;
  position: relative;
  /* Added for positioning context */
}

.flex-container2>div {
  font-weight: normal;
  flex-grow: 1;
  border-radius: 0px;
  width: max-content;
  margin: 1px;
  text-align: left;
  width: 500px;
}

p {
  text-align: justify;
  line-height: 1.5;
  height: auto;
  color: #4a90e2;
  font-family: Arial, sans-serif;
  font-size: 16px;
}

a:link {
  color: #b5ac97;
  background-color: transparent;
  text-decoration: none;
}

a:visited {
  color: #bbd853;
  background-color: transparent;
  text-decoration: none;
}

a:hover {
  color: red;
  background-color: transparent;
  text-decoration: none;
}

a:active {
  color: yellow;
  background-color: transparent;
  text-decoration: underline;
}

img {
  border: 1px solid transparent;
  vertical-align: middle;
  border-radius: 10px;
}

.link-group-content {
  list-style: none;
  /* Remove default list bullets */
  padding: 10px;
  /* Remove default padding */
  flex-wrap: wrap;
  justify-content: left;
  background-color: #252525;
  border-radius: 10px;
}

.link-group-content[style*="display: list-item"] {
  flex-wrap: nowrap;
  justify-content: flex-start;
  width: fit-content;
  padding-right: 18px;
}

.link-group-content[style*="display: list-item"] .link-item {
  margin-bottom: 10px;
  width: 100%;
}

.link-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  /* Center the link and buttons horizontally */
  margin: 5px;
  /* Add some margin around each item */
  padding: 5px;
  background-color: #474747;
  border-radius: 5px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  transition: transform 0.3s ease;
  justify-content: center;
}

.link-item:hover {
  transform: scale(1.02);
  background-color: #000000;
  transition: .3s;
}

.link-item a {
  /* Styles for the link itself within the container */
  display: block;
  /* Make the span take full width */
  padding: 10px 5px;
  width: fit-content;
  height: fit-content;
  font-family: jetbrainsmono nfp;
  align-content: center;
  background-color: transparent;
  /* Remove background from the span itself */
  box-shadow: none;
  margin: 0;
  /* Remove margin from the span */
}

.link-buttons {
  display: flex;
  justify-content: center;
  margin-top: 5px;
  /* Space between link and buttons */
}

.add-link-item {
  max-height: fit-content;
  align-self: center;
}

.add-link-item:hover {
  background-color: #4CAF50;
  /* Green color on hover */
}

.toggle-container span {
  /* Reset properties for the toggle label span */
  display: inline;
  padding: 0;
  background-color: transparent;
  border-radius: 0;
  box-shadow: none;
  transition: none;
  margin: 0;
  width: auto;
  height: auto;
  font-family: Calibri;
  /* Or your preferred default font */
  font-size: 16px;
  /* Or your preferred default font size */
  align-content: center;
}

.toggle-container span:hover {
  transform: none;
  background-color: transparent;
}

.toggle-container {
  position: absolute;
  top: 10px;
  left: 10px;
  transform: none;
  display: flex;
  align-items: center;
  z-index: 1000;
}

/* The switch - the box around the slider */
.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

/* Hide default HTML checkbox */
.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

/* The slider */
.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked+.slider {
  background-color: #2196F3;
}

input:focus+.slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked+.slider:before {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
}

/* Rounded sliders */
.slider.round {
  border-radius: 34px;
}

.slider.round:before {
  border-radius: 50%;
}

.edit-button,
.delete-button {
  display: none;
  /* Hidden by default */
  font-family: jetbrainsmono nfp;
}

.edit-mode .edit-button,
.edit-mode .delete-button {
  display: inline-block;
  /* Show when edit mode is active */
}

/* Popup styles - Enhanced centering */
.popup-container {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: 9999 !important;
  display: flex;
  justify-content: center !important;
  align-items: center !important;
  /* Override any parent flex properties */
  flex-direction: row !important;
  flex-wrap: nowrap !important;
  margin: 0 !important;
  padding: 0 !important;
  border-radius: 0 !important;
  /* Ensure it's not affected by parent container */
  pointer-events: auto;
}

.hidden {
  display: none !important;
}


.popup-content {
  background-color: #31343a;
  padding: 20px;
  border-radius: 8px;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);

  width: 100%;
  max-width: fit-content;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.popup-content .close-button {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 24px;
  cursor: pointer;
  color: #fff;
  background-color: #ff2d2d;
  height: 25px;
  width: 25px;
  text-align: center;
  border-radius: 15%;
  padding-bottom: 30px;
}

.link-group h3 {
  color: #ffffff;
  margin-bottom: 10px;
  border-bottom: 1px solid #555;
  padding-bottom: 5px;
}

.edit-button,
.delete-button {
  background-color: #4CAF50;
  /* Green */
  color: white;
  padding: 5px 10px;
  border: none;
  border-radius: 3px;
  cursor: pointer;
  font-size: 14px;
  margin-left: 5px;
}

.delete-button {
  background-color: #f44336;
  /* Red */
}

.edit-button:hover {
  background-color: #45a049;
}

.delete-button:hover {
  background-color: #da190b;
}

.popup-container input[type="text"],
.popup-container input[type="url"],
.popup-container input[type="color"] {
  flex-grow: 1;
  /* Allow inputs to grow within a flex container */
  min-width: 120px;
  /* Ensure a minimum width */
  padding: 8px;
  margin-bottom: 0;
  /* Remove individual margin-bottom, use gap on parent */
  border-radius: 4px;
  border: 1px solid #ddd;
  background-color: #555;
  color: white;
}

.popup-container button[type="submit"] {
  background-color: #007bff;
  color: white;
  padding: 10px 15px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
}

.popup-container button[type="submit"]:hover {
  background-color: #0056b3;
}


/* Group header container for title and edit button */
.group-header-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 0px;
}

.group-title {
  flex-grow: 1;
  margin: 0;
  padding-right: 10px;
}

/* Edit group button styling */
.edit-group-button {
  display: none;
  /* Hidden by default */
  background-color: #ffffff;
  color: white;
  border: none;
  padding: 5px 8px;
  border-radius: 3px;
  cursor: pointer;
  font-size: 14px;
  margin-left: 10px;
}

.edit-group-button:hover {
  background-color: #45a049;
}

/* Show edit group button in edit mode */
.edit-mode .edit-group-button {
  display: inline-block;
}

/* Additional styling for the edit group popup */
#edit-group-popup .popup-content {
  min-width: 400px;
}

#edit-group-popup input[type="text"] {
  padding: 10px;
  font-size: 16px;
  border-radius: 4px;
  border: 1px solid #ddd;
  background-color: #555;
  color: white;
}

#edit-group-popup label {
  color: white;
  font-weight: bold;
  margin-bottom: 5px;
}

#edit-group-popup button[type="submit"] {
  background-color: #007bff;
  color: white;
  padding: 12px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  margin-top: 10px;
}

#edit-group-popup button[type="submit"]:hover {
  background-color: #0056b3;
}


/* items modified to make it look good */
ul.link-group-content {
  margin-top: 0;
}

div.group-header-container {
  margin-top: 0;
}

html body {
  margin-top: 20px;
}

div.toggle-container {
  margin-top: -16px;
}

/* Collapsible groups styling */
.collapsible-groups-container {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-bottom: 20px;
  padding: 10px;
  background-color: #1e1e1e;
  border-radius: 10px;
}

.collapsible-groups-row {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}

.collapsible-group {
  background-color: #2d2d2d;
  border-radius: 8px;
  padding: 10px;
  min-width: 200px;
  max-width: 300px;
  transition: all 0.3s ease;
}

.collapsible-group.expanded {
  width: 100%;
  max-width: 100%;
  order: -1;
}

.collapsible-group-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  cursor: pointer;
  padding: 5px 0;
  border-bottom: 1px solid #444;
  margin-bottom: 10px;
}

.collapsible-group-header .edit-buttons {
  display: none;
  gap: 5px;
  margin-left: 10px;
}

.edit-mode .collapsible-group-header .edit-buttons {
  display: flex;
}

.collapsible-group-title {
  color: #ffffff;
  margin: 0;
  font-size: 16px;
  flex-grow: 1;
}

.collapsible-toggle-btn {
  background: none;
  border: none;
  color: #ffffff;
  font-size: 18px;
  cursor: pointer;
  padding: 0;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.collapsible-group-content {
  display: none;
  list-style: none;
  padding: 0;
  margin: 0;
}

.collapsible-group-content.expanded {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}

.collapsible-group-content .link-item {
  margin: 5px 0;
  padding: 8px;
  background-color: #3a3a3a;
  flex: 0 0 auto;
}

.collapsible-group-content .link-item:hover {
  background-color: #4a4a4a;
}

.collapsible-edit-btn {
  background-color: #4CAF50;
  color: white;
  border: none;
  padding: 3px 6px;
  border-radius: 3px;
  cursor: pointer;
  font-size: 12px;
}

.collapsible-edit-btn:hover {
  background-color: #45a049;
}

/* Drag and drop styling for collapsible groups */
.collapsible-group.dragging {
  opacity: 0.5;
  transform: rotate(2deg);
}

.collapsible-group {
  cursor: move;
}

.collapsible-group-header {
  cursor: pointer;
}

/* Prevent header clicks during drag operations */
.collapsible-group.drag-active .collapsible-group-header {
  pointer-events: none;
}

.collapsible-group.drag-active .collapsible-group-content {
  pointer-events: auto;
}

/* Enhanced styling for expanded groups */
.collapsible-groups-row.expanded-row {
  order: -1;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 2px solid #444;
}

.collapsible-groups-row.expanded-row .collapsible-group {
  width: 100%;
  max-width: 100%;
}

/* Ensure expanded row is properly cleaned up */
.collapsible-groups-row:empty {
  display: none;
  margin: 0;
  padding: 0;
  border: none;
}

/* Drag over effect */
.collapsible-group.drag-over {
  border: 2px dashed #4CAF50;
  background-color: #2a4a2a;
}

/* Visual feedback for dragging items */
.link-item.dragging {
  opacity: 0.5;
  transform: scale(0.95);
  z-index: 1000;
}
  </style>
</head>

<body>
  <div class="flex-container2">

    <div class="toggle-container" style="margin-left: 25px;">
      <label class="switch">
        <input type="checkbox" id="edit-mode-toggle">
        <span class="slider round"></span>
      </label>
      <span style="color: white; margin-left: 10px;">Modify</span>
    </div>

    <!-- Updated styling for better edit mode control -->
    <style>
      .dragging {
        opacity: 0.5;
      }
      
      .reorder-buttons {
        display: none;
        flex-direction: column;
        gap: 2px;
        margin-left: 5px;
      }
      .edit-mode .reorder-buttons {
        display: none;
      }
      .reorder-btn {
        background: #333;
        color: white;
        border: none;
        padding: 2px 6px;
        cursor: pointer;
        font-size: 12px;
        border-radius: 3px;
      }
      .reorder-btn:hover {
        background: #555;
      }
      
      /* Group reorder buttons - only visible in edit mode */
      .group-reorder-buttons {
        display: none;
        gap: 5px;
        margin-left: 10px;
      }
      .edit-mode .group-reorder-buttons {
        display: flex;
      }
      
      .link-item {
        cursor: move;
      }

    </style>

  <div id="links-container" style="display: flex; width: 100%; flex-wrap: wrap; justify-content: left; flex-direction: column;">
  </div>

  <script>
    // Embedded data
    const STATIC_LINKS_DATA = [
  {
    "collapsible": true,
    "default_type": "nerd-font",
    "display_style": "flex",
    "group": "JobCircular",
    "name": "erecruitment",
    "url": "https://erecruitment.bb.org.bd/"
  },
  {
    "collapsible": true,
    "default_type": "nerd-font",
    "display_style": "flex",
    "group": "JobCircular",
    "name": "bepza",
    "title": "Bangladesh Export Processing Zones Authority",
    "url": "https://www.bepza.gov.bd/career"
  },
  {
    "collapsible": true,
    "default_type": "nerd-font",
    "display_style": "flex",
    "group": "JobCircular",
    "name": "dnc",
    "title": "Department of Narcotics Control Security Services Division Ministry of Home Affairs",
    "url": "http://dnc.teletalk.com.bd/"
  },
  {
    "collapsible": true,
    "default_type": "nerd-font",
    "display_style": "flex",
    "group": "JobCircular",
    "name": "bpsc",
    "title": "Bangladesh Public Service Commission",
    "url": "http://bpsc.teletalk.com.bd/"
  },
  {
    "collapsible": true,
    "default_type": "nerd-font",
    "display_style": "flex",
    "group": "JobCircular",
    "name": "brdb",
    "url": "http://brdb.teletalk.com.bd/"
  },
  {
    "collapsible": true,
    "default_type": "nerd-font",
    "display_style": "flex",
    "group": "JobCircular",
    "name": "ndr",
    "text": "ndr",
    "url": "http://ndr.teletalk.com.bd/"
  },
  {
    "collapsible": true,
    "default_type": "nerd-font",
    "display_style": "flex",
    "group": "JobCircular",
    "name": "bscic",
    "title": "Bangladesh Small and Cottage Industries Corporation",
    "url": "http://bscic.teletalk.com.bd/bscic25/index.php"
  },
  {
    "color": "#f46613",
    "default_type": "nerd-font",
    "font_size": "35px",
    "icon_class": "nf nf-cod-mail",
    "img_src": "https://static.vecteezy.com/system/resources/previews/022/613/021/non_2x/google-mail-gmail-icon-logo-symbol-free-png.png",
    "name": "Google Mail",
    "url": "https://mail.google.com/"
  },
  {
    "color": "#1399f4",
    "default_type": "nerd-font",
    "font_size": "35px",
    "icon_class": "nf nf-dev-facebook",
    "img_src": "https://img.icons8.com/ios11/512/facebook-new.png",
    "name": "Facebook",
    "url": "https://www.facebook.com/"
  },
  {
    "color": "#3675ff",
    "default_type": "nerd-font",
    "font_size": "35px",
    "icon_class": "nf nf-fa-facebook_messenger",
    "name": "Messenger",
    "url": "https://www.messenger.com/"
  },
  {
    "color": "#ff0000",
    "default_type": "nerd-font",
    "font_size": "35px",
    "icon_class": "nf nf-fa-youtube",
    "name": "YouTube",
    "url": "https://www.youtube.com/"
  },
  {
    "color": "#5765f2",
    "default_type": "nerd-font",
    "font_size": "35px",
    "icon_class": "nf nf-fa-discord",
    "name": "Discord",
    "url": "https://discord.com/channels/@me"
  },
  {
    "color": "#ffffff",
    "default_type": "nerd-font",
    "font_size": "35px",
    "icon_class": "nf nf-md-google_translate",
    "name": "Google Translate",
    "url": "https://translate.google.com/?hl=en&tab=TT&sl=bn&tl=en&op=translate"
  },
  {
    "default_type": "img",
    "img_src": "https://www.vlr.gg/img/vlr/logo_tw.png",
    "name": "VLR.gg",
    "url": "https://www.vlr.gg/"
  },
  {
    "color": "#4b70cc",
    "default_type": "nerd-font",
    "font_size": "35px",
    "icon_class": "nf nf-md-dots_hexagon",
    "name": "Tailscale",
    "url": "https://login.tailscale.com/admin/machines"
  },
  {
    "default_type": "text",
    "img_src": "https://d2qr50rz2oof04.cloudfront.net/assets/img/logo/logo-bug.png",
    "name": "noip",
    "text": "noip<br>Aug7",
    "url": "https://my.noip.com/dynamic-dns"
  },
  {
    "color": "#b259e6",
    "default_type": "nerd-font",
    "font_size": "35px",
    "icon_class": "nf nf-md-microsoft_onenote",
    "name": "OneNote",
    "url": "https://www.onenote.com/"
  },
  {
    "default_type": "nerd-font",
    "font_size": "35px",
    "icon_class": "nf nf-fa-github_square",
    "name": "github",
    "url": "https://github.com/nahid6970"
  },
  {
    "color": "#fbbc04",
    "default_type": "nerd-font",
    "font_size": "35px",
    "icon_class": "nf nf-md-google_keep",
    "name": "Keep",
    "url": "https://keep.google.com/"
  },
  {
    "color": "#ff2e2e",
    "default_type": "nerd-font",
    "font_size": "35px",
    "hidden": true,
    "icon_class": "nf nf-fa-battery_2",
    "name": "mi9t",
    "title": "mi9t",
    "url": "http://mi9t:5002"
  },
  {
    "color": "#69e8ff",
    "default_type": "nerd-font",
    "font_size": "35px",
    "icon_class": "nf nf-seti-font",
    "name": "nerdfonts",
    "url": "https://www.nerdfonts.com/cheat-sheet"
  },
  {
    "collapsible": false,
    "default_type": "img",
    "display_style": "flex",
    "font_size": "35px",
    "group": "Local (Apps)",
    "icon_class": "nf nf-md-television_classic",
    "img_src": "http://192.168.0.101:8989/Content/Images/logo.svg",
    "name": "Sonarr",
    "text": "Sonarr",
    "top_bg_color": "#2d2d2d",
    "top_border_color": "#444444",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "http://192.168.0.101:8989/"
  },
  {
    "collapsible": false,
    "default_type": "img",
    "display_style": "flex",
    "font_size": "35px",
    "group": "Local (Apps)",
    "icon_class": "nf-md-movie_roll",
    "img_src": "http://192.168.0.101:7878/Content/Images/Icons/logo-radarr.png",
    "name": "Radarr",
    "text": "Radarr",
    "top_bg_color": "#2d2d2d",
    "top_border_color": "#444444",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "http://192.168.0.101:7878/"
  },
  {
    "collapsible": false,
    "default_type": "img",
    "display_style": "flex",
    "group": "Local (Apps)",
    "height": "50",
    "img_src": "http://192.168.0.101:9696/Content/Images/logo.png",
    "name": "Prowlarr",
    "top_bg_color": "#2d2d2d",
    "top_border_color": "#444444",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "http://192.168.0.101:9696/",
    "width": "50"
  },
  {
    "collapsible": false,
    "default_type": "img",
    "display_style": "flex",
    "group": "Local (Apps)",
    "img_src": "http://192.168.0.101:6767/images/logo64.png",
    "name": "Bazarr",
    "top_bg_color": "#2d2d2d",
    "top_border_color": "#444444",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "http://192.168.0.101:6767/series"
  },
  {
    "collapsible": false,
    "default_type": "img",
    "display_style": "flex",
    "group": "Local (Apps)",
    "img_src": "http://127.0.0.1:9117/jacket_medium.png",
    "name": "JackettAPI ",
    "top_bg_color": "#2d2d2d",
    "top_border_color": "#444444",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "http://127.0.0.1:9117/UI/Dashboard"
  },
  {
    "collapsible": false,
    "color": "#20acd7",
    "default_type": "nerd-font",
    "display_style": "flex",
    "font_size": "35px",
    "group": "Local (Apps)",
    "icon_class": "nf nf-md-folder_sync",
    "img_src": "http://127.0.0.1:8384/assets/img/logo-horizontal.svg",
    "name": "Syncthing",
    "top_bg_color": "#2d2d2d",
    "top_border_color": "#444444",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "http://127.0.0.1:8384/"
  },
  {
    "collapsible": false,
    "default_type": "nerd-font",
    "display_style": "flex",
    "font_size": "35px",
    "group": "Local (Apps)",
    "icon_class": "nf nf-linux-tor",
    "img_src": "http://192.168.0.101:8080/images/qbittorrent-tray.svg",
    "name": "qBittorrent",
    "top_bg_color": "#2d2d2d",
    "top_border_color": "#444444",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "http://192.168.0.101:8080/"
  },
  {
    "collapsible": false,
    "color": "#009fff",
    "default_type": "nerd-font",
    "display_style": "flex",
    "font_size": "35px",
    "group": "Local (Apps)",
    "icon_class": "nf nf-fa-wifi",
    "name": "WIFI",
    "top_bg_color": "#2d2d2d",
    "top_border_color": "#444444",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "http://192.168.0.1/"
  },
  {
    "default_type": "img",
    "group": "Chat-BOT",
    "img_src": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAaVBMVEVHcEwdHR0AAAEFBQYCAgIDAwQJCQkBAQJaWlojJScLOGwXhf0TExQQWq8QEBE8PDxLS0swMDH09PT///+FhYVaW1qam5oaGxvd3d27u7tvcG8sLixCQ0NSUlF0dXVvcHB7fHw/QEBNTk0iDk46AAAAI3RSTlMAN4O42en//yb///+F//////////7////////LuoK35YLWhTozBjoAAAGBSURBVHgBfZMFlsMwDAUdkqqCoYmqxst7/0Put1PK0pQ7E9N7cZWm7fqB+AYNfdc27sqm41/pNpfLB/6DoanX/+mJhzJGx//QYYI/lAgXGtf+7re73ZbB/q8ZDrvdgYl953pe8CEKV1KMEcEBP8n37rqHdBwnLuhxHE9w9SoaHK2Dq68QhnC8Dq6ersU6uHoCsP5HcPUVBObXgY6L50tgtl7DGdef4a94T+ugcg5LUqQQyzqYz+N4nFDA4+FNwiqYWeaSGbP3CCSl9BDAg1OZZhICCAKC344aX30pQgo/jprqNBNZRYIbeElkPmcGHj91zgICnsn1VIMrtPQpWNJgQZ9c50uxithblBRDTBqf3V7MY1g8ES5p2Z4FSRJVX1zjBXu2uvFlEkkgpCQJwca5J5MURPBuaMjgTOBDjFFfy42jQSMIQeCyxmCGVoKqvmEAFG85K4gxT3hoEjOTePWleM2T5pynE8iao4kE9M8XD5r31zfoGcE05USUPl4/m6q+ALq7K1Ui7+ebAAAAAElFTkSuQmCC",
    "name": "KIMI-K2",
    "url": "https://www.kimi.com/"
  },
  {
    "collapsible": false,
    "default_type": "img",
    "display_style": "flex",
    "group": "Chat-BOT",
    "img_src": "https://static.vecteezy.com/system/resources/previews/024/558/807/non_2x/openai-chatgpt-logo-icon-free-png.png",
    "name": "ChatGPT",
    "top_bg_color": "#",
    "top_border_color": "#ec2222",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "https://chatgpt.com/"
  },
  {
    "collapsible": false,
    "default_type": "img",
    "display_style": "flex",
    "group": "Chat-BOT",
    "img_src": "https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/dark/deepseek-color.png",
    "name": "DeepSeek",
    "top_bg_color": "#",
    "top_border_color": "#ec2222",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "https://chat.deepseek.com/"
  },
  {
    "collapsible": false,
    "default_type": "img",
    "display_style": "flex",
    "group": "Chat-BOT",
    "img_src": "https://img.icons8.com/fluent/512/claude-ai.png",
    "li_hover_color": "#d97757",
    "name": "Claude",
    "top_bg_color": "#",
    "top_border_color": "#ec2222",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "https://claude.ai/new"
  },
  {
    "collapsible": false,
    "default_type": "img",
    "display_style": "flex",
    "group": "Chat-BOT",
    "img_src": "https://upload.wikimedia.org/wikipedia/commons/f/f0/Google_Bard_logo.svg",
    "name": "Google Bard",
    "top_bg_color": "#",
    "top_border_color": "#ec2222",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "https://bard.google.com/"
  },
  {
    "collapsible": false,
    "default_type": "img",
    "display_style": "flex",
    "group": "Chat-BOT",
    "img_src": "https://www.techspot.com/images2/downloads/topdownload/2025/07/2025-07-14-ts3_thumbs-d25.png",
    "li_bg_color": "white",
    "name": "KIRO",
    "top_bg_color": "#",
    "top_border_color": "#ec2222",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "https://kiro.dev/"
  },
  {
    "collapsible": false,
    "default_type": "img",
    "display_style": "flex",
    "group": "Chat-BOT",
    "img_src": "https://ollama.com/public/ollama.png",
    "li_bg_color": "white",
    "name": "ollama-chat",
    "top_bg_color": "#",
    "top_border_color": "#ec2222",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "http://localhost:8000/",
    "width": "40"
  },
  {
    "collapsible": false,
    "default_type": "nerd-font",
    "display_style": "flex",
    "group": "Chat-BOT",
    "name": "mcp",
    "top_bg_color": "#",
    "top_border_color": "#ec2222",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "https://github.com/modelcontextprotocol/servers"
  },
  {
    "collapsible": false,
    "default_type": "nerd-font",
    "display_style": "flex",
    "group": "Chat-BOT",
    "name": "mcp-host",
    "top_bg_color": "#",
    "top_border_color": "#ec2222",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "https://github.com/mark3labs/mcphost"
  },
  {
    "default_type": "img",
    "group": "Local (Flask)",
    "img_src": "https://cdn-icons-png.flaticon.com/512/4400/4400968.png",
    "name": "ShareTXT",
    "url": "http://192.168.0.101:5001/"
  },
  {
    "default_type": "img",
    "group": "Local (Flask)",
    "img_src": "https://cdn-icons-png.flaticon.com/512/2840/2840124.png",
    "name": "ShareFile",
    "url": "http://192.168.0.101:5002/"
  },
  {
    "default_type": "img",
    "group": "Local (Flask)",
    "img_src": "https://cdn-icons-png.flaticon.com/512/2250/2250195.png",
    "name": "Browse",
    "url": "http://192.168.0.101:5003/"
  },
  {
    "default_type": "nerd-font",
    "group": "Local (Flask)",
    "name": "GameARR",
    "url": "http://192.168.0.101:5005/"
  },
  {
    "default_type": "nerd-font",
    "font_size": "35px",
    "group": "Local (Flask)",
    "icon_class": "nf nf-oct-command_palette",
    "name": "Command",
    "url": "http://192.168.0.101:5007/"
  },
  {
    "default_type": "img",
    "group": "Local (Flask)",
    "img_src": "https://cdn-icons-png.flaticon.com/512/4021/4021539.png",
    "name": "myhome",
    "url": "https://nahid6970.github.io/ms1/myhome/myhome"
  },
  {
    "default_type": "img",
    "group": "Download PKG",
    "img_src": "http://fitgirl-repacks.site/wp-content/uploads/2016/08/cropped-icon-192x192.jpg",
    "name": "Fitgirl",
    "url": "https://fitgirl-repacks.site/"
  },
  {
    "default_type": "nerd-font",
    "group": "Download PKG",
    "name": "romsfun",
    "url": "https://romsfun.com/"
  },
  {
    "default_type": "nerd-font",
    "group": "Download PKG",
    "name": "DODI",
    "url": "https://dodi-repacks.site/"
  },
  {
    "default_type": "img",
    "group": "Download PKG",
    "img_src": "https://avatars.githubusercontent.com/u/16618068?s=30",
    "name": "Scoop",
    "url": "https://scoop.sh/#/"
  },
  {
    "default_type": "img",
    "group": "Download PKG",
    "img_src": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MC40OTIiIGhlaWdodD0iNDUuOTg2IiB2aWV3Qm94PSIwIDAgNDAuNDkyIDQ1Ljk4NiI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTgzNS4xMzEgLTcyLjEzNikiPjxsaW5lIHkyPSIyMS41NDciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDg1NS4yOTUgOTUuMjExKSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0ibm9uZSIvPjxsaW5lIHgxPSIxOC45NiIgeTI9IjExLjAyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4NTUuMjk1IDg0LjE5MSkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjZmZmIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiLz48bGluZSB4MT0iMTguOTYiIHkyPSIxMC42OTEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDg1NS4yOTUgMTA2LjA2NykiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjZmZmIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiLz48bGluZSB5Mj0iMjEuODc2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4NzQuMjU1IDg0LjE5MSkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjZmZmIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiLz48bGluZSB4MT0iMTguOTYiIHkxPSIxMC42OTEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDg1NS4yOTUgNzMuNSkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjZmZmIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiLz48bGluZSB5MT0iMTAuNjkxIiB4Mj0iMTguNzk1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4MzYuNSA3My41KSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0ibm9uZSIvPjxsaW5lIHgyPSIxOC43OTUiIHkyPSIxMS4wMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODM2LjUgODQuMTkxKSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0ibm9uZSIvPjxsaW5lIHkxPSIyMS44NzYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgzNi41IDg0LjE5MSkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjZmZmIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiLz48bGluZSB4MT0iMTguNzk1IiB5MT0iMTAuNjkxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4MzYuNSAxMDYuMDY3KSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0ibm9uZSIvPjxsaW5lIHkxPSI1LjA5OSIgeDI9IjguNzM4IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4MzYuNSAxMDAuOTY4KSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0ibm9uZSIvPjxsaW5lIHkyPSIxMS42NzgiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDg0NS4yMzggODkuMjkpIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBmaWxsPSJub25lIi8+PGxpbmUgeDI9IjEwLjA1NyIgeTI9IjUuNzU3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4NDUuMjM4IDEwMC45NjgpIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBmaWxsPSJub25lIi8+PGxpbmUgeTE9IjUuNzU3IiB4Mj0iMTAuMjIyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4NTUuMjk1IDEwMC45NjgpIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBmaWxsPSJub25lIi8+PGxpbmUgeTI9IjExLjY3OCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODY1LjUxNyA4OS4yOSkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjZmZmIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiLz48bGluZSB4Mj0iMTAuMjIyIiB5Mj0iNi4wODYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDg1NS4yOTUgODMuMjA0KSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0ibm9uZSIvPjxsaW5lIHgxPSIxMC4wNTciIHkyPSI2LjA4NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODQ1LjIzOCA4My4yMDQpIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBmaWxsPSJub25lIi8+PGxpbmUgeTI9IjkuNzA0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4NTUuMjk1IDczLjUpIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBmaWxsPSJub25lIi8+PGxpbmUgeDI9IjguNzM4IiB5Mj0iNS4wOTkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDg2NS41MTcgMTAwLjk2OCkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSIjZmZmIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9Im5vbmUiLz48L2c+PC9zdmc+",
    "name": "Winget",
    "url": "https://winget.run/"
  },
  {
    "default_type": "nerd-font",
    "group": "Linux",
    "name": "protondb",
    "url": "https://www.protondb.com/explore"
  },
  {
    "default_type": "img",
    "group": "Download PKG",
    "img_src": "https://apps.evozi.com/apk-downloader/assets/img/mini_icon.png",
    "name": "evozi",
    "url": "https://apps.evozi.com/apk-downloader/"
  },
  {
    "default_type": "nerd-font",
    "font_size": "35px",
    "group": "Download PKG",
    "icon_class": "nf nf-fa-microsoft",
    "img_src": "https://store.rg-adguard.net/img/Store.png",
    "name": "MS-Store",
    "url": "https://store.rg-adguard.net/"
  },
  {
    "collapsible": true,
    "default_type": "nerd-font",
    "display_style": "flex",
    "group": "info / News",
    "name": "diyabari milestone school & college \ud83c\udfaf proshikhon biman blast // 21 july // Chengdu F-7BGI (Combat Jet)",
    "top_bg_color": "#2d2d2d",
    "top_border_color": "#444444",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "http://example.com"
  },
  {
    "default_type": "nerd-font",
    "group": "Linux",
    "name": "ProtonPLUS",
    "url": "https://github.com/Vysp3r/ProtonPlus"
  },
  {
    "default_type": "nerd-font",
    "group": "Linux",
    "name": "Wayland-Protocol addoption info",
    "url": "https://absurdlysuspicious.github.io/wayland-protocols-table/"
  },
  {
    "collapsible": false,
    "default_type": "img",
    "display_style": "flex",
    "group": "Chat-BOT",
    "img_src": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAMAAABF0y+mAAAAgVBMVEVHcExNOe5hVu5ua/FiTe2AbO3HxPhhUetpYu5va/BaS/FDCubc2fr///9jWO2Hf/Dl4/xaQ+pdVu94ffRZQuvv7f13e/Kll/GZivBeQer5+P9NC+RXOOhcS+vCvPbUz/i5svVlXe5YTO5WHeVSLOetpPNiMuZiPuhiSephU+xfI+XgKL3tAAAAK3RSTlMALsbAa/3/////Fnz///////+Ifqv//v//1P/////////dWP////////XBmCbmPwAAAWxJREFUeAFtkQViwzAMAMMqGLO6dZgTb/9/4CRv5V4xOZGV4EYYxXGcBJ9JM9jt94eP7sj4Xux28UcpOVcabf71x6M7Gc65Fmix9v58lg/dwws6qwFIe3v+E4cwDAtVclXVWjdN8x/w5d0+a9tLZnjXejJ8I50kGWlFJVnJn1A5dROwx/9Zb56l7zkIoTNK7Tv2QD+SzIWAhspU0zTPc13X89Ijp4BAqRdKXdcNcdqWxphyCUmOAmDGhuVE1m31/2RDQAwAWuJVP1Fq3eNfWkmXkAwB3MzwcvOp+IfNLX7Lv72C24Biq3WdOvyzczSiyX1XcM7Hpuua4k9buya11vqu3yi3mWKrilZRO+doxzRvDoAzThYHlpamIQkAkT8oTmuX5cJLZUtMnzbn7SHwmU5wwrR/jbetwMdIDoGakSuZpZEnPCx1+2dMjULYcj3sKXggOf7R05pQBp/4KTm6NfkoD/ZCMvhM8oPcp/kFeWsqRiVRXjsAAAAASUVORK5CYII=",
    "name": "qwen",
    "top_bg_color": "#",
    "top_border_color": "#ec2222",
    "top_hover_color": "#3a3a3a",
    "top_text_color": "#ffffff",
    "url": "https://chat.qwen.ai/"
  },
  {
    "name": "AgentOS",
    "group": "Chat-BOT",
    "url": "https://github.com/buildermethods/agent-os",
    "default_type": "nerd-font"
  },
  {
    "name": "openrouter",
    "group": "Chat-BOT",
    "url": "https://openrouter.ai/",
    "default_type": "nerd-font"
  },
  {
    "name": "SuperDesign Dev",
    "group": "Chat-BOT",
    "url": "https://github.com/superdesigndev/superdesign",
    "default_type": "nerd-font"
  }
];
    
    // Override fetch for static version
    const originalFetch = window.fetch;
    window.fetch = function(url, options) {
      if (url === '/api/links' && (!options || options.method === 'GET' || !options.method)) {
        return Promise.resolve({
          ok: true,
          json: () => Promise.resolve(STATIC_LINKS_DATA)
        });
      }
      // For other requests, show a message that editing is not available
      if (url.startsWith('/api/')) {
        alert('Editing is not available in static version. Use the live version to make changes.');
        return Promise.reject(new Error('Static version - editing disabled'));
      }
      return originalFetch.apply(this, arguments);
    };
    
    /* For Showing Markdown Table in HTML properly but lines also show */
 function parseMarkdownTable(markdown) {
  const rows = markdown.trim().split('\n');
  const headers = rows[1].split('|').map(header => header.trim()).filter(Boolean);
  const data = rows.slice(2, -1).map(row => row.split('|').map(cell => cell.trim()).filter(Boolean));

  return { headers, data };
}

function renderTable(headers, data) {
  const tableElement = document.createElement('table');
  const theadElement = document.createElement('thead');
  const tbodyElement = document.createElement('tbody');

  const headerRow = document.createElement('tr');
  headers.forEach(header => {
      const thElement = document.createElement('th');
      thElement.textContent = header;
      headerRow.appendChild(thElement);
  });

  theadElement.appendChild(headerRow);

  data.forEach(rowData => {
      const rowElement = document.createElement('tr');
      rowData.forEach(cellData => {
          const tdElement = document.createElement('td');
          tdElement.textContent = cellData;
          rowElement.appendChild(tdElement);
      });
      tbodyElement.appendChild(rowElement);
  });

  tableElement.appendChild(theadElement);
  tableElement.appendChild(tbodyElement);

  return tableElement;
}

function convertMarkdownTables() {
  const elements = document.querySelectorAll('[id^="markdown-table-"]');
  elements.forEach(element => {
      const markdownContent = element.innerHTML;
      const { headers, data } = parseMarkdownTable(markdownContent);
      const tableElement = renderTable(headers, data);
      element.innerHTML = ''; // Clear the original content
      element.appendChild(tableElement);
  });
}
// Call the function to convert Markdown tables on page load
window.addEventListener('load', convertMarkdownTables); 
 

/* // Get all the spans
const spans = document.querySelectorAll('span');

// Find the span with the maximum width
let maxWidth = 0;
spans.forEach(span => {
  const width = span.offsetWidth;
  if (width > maxWidth) {
    maxWidth = width;
  }
});

// Set the width of all spans to the maximum width
spans.forEach(span => {
  span.style.width = `${maxWidth}px`;
}); */


// Popup functionality
document.addEventListener('DOMContentLoaded', () => {
  const addLinkPopup = document.getElementById('add-link-popup');
  const editLinkPopup = document.getElementById('edit-link-popup');
  const editGroupPopup = document.getElementById('edit-group-popup');

  // Close buttons for addLinkPopup
  const addCloseButton = addLinkPopup ? addLinkPopup.querySelector('.close-button') : null;
  if (addCloseButton) {
    addCloseButton.addEventListener('click', () => {
      addLinkPopup.classList.add('hidden');
    });
  }

  // Close buttons for editLinkPopup
  const editCloseButton = editLinkPopup ? editLinkPopup.querySelector('.close-button') : null;
  if (editCloseButton) {
    editCloseButton.addEventListener('click', () => {
      editLinkPopup.classList.add('hidden');
    });
  }

  // Close buttons for editGroupPopup
  const editGroupCloseButton = editGroupPopup ? editGroupPopup.querySelector('.close-button') : null;
  if (editGroupCloseButton) {
    editGroupCloseButton.addEventListener('click', () => {
      editGroupPopup.classList.add('hidden');
    });
  }

  // Close popups when clicking outside
  window.addEventListener('click', (event) => {
    if (event.target === addLinkPopup) {
      addLinkPopup.classList.add('hidden');
    }
    if (event.target === editLinkPopup) {
      editLinkPopup.classList.add('hidden');
    }
    if (event.target === editGroupPopup) {
      editGroupPopup.classList.add('hidden');
    }
  });
});

document.addEventListener('keydown', (event) => {
  if (event.key === 'F1') {
    event.preventDefault();
    const toggle = document.getElementById('edit-mode-toggle');
    toggle.checked = !toggle.checked;
    const changeEvent = new Event('change');
    toggle.dispatchEvent(changeEvent);
  }
});
    
    document.addEventListener('DOMContentLoaded', function() {
  const linksContainer = document.getElementById('links-container');
  const addLinkForm = document.getElementById('add-link-form');
  let links = []; // Declare links here so it's accessible globally

  // Function to fetch and display links
  async function fetchAndDisplayLinks() {
    try {
      const response = await fetch('/api/links');
      links = await response.json(); // Assign to the global links variable
      linksContainer.innerHTML = ''; // Clear existing links

      const groupedElements = {}; // Store HTML elements grouped by name
      const groupedLinks = {}; // Store original links grouped by name
      const collapsibleGroups = {}; // Store collapsible groups separately

      links.forEach((link, index) => { // Use the index from the original links array
        // Skip hidden items unless in edit mode
        if (link.hidden && !document.querySelector('.flex-container2').classList.contains('edit-mode')) {
          return;
        }

        const groupName = link.group || 'Ungrouped';
        if (!groupedElements[groupName]) {
          groupedElements[groupName] = [];
          groupedLinks[groupName] = [];
        }

        const listItem = document.createElement('li');
        listItem.className = 'link-item';
        listItem.draggable = true;
        listItem.dataset.linkIndex = index;
        
        // Add drag event listeners
        listItem.addEventListener('dragstart', handleDragStart);
        listItem.addEventListener('dragover', handleDragOver);
        listItem.addEventListener('drop', handleDrop);
        listItem.addEventListener('dragend', handleDragEnd);
        
        // Add visual indicator for hidden items in edit mode
        if (link.hidden && document.querySelector('.flex-container2').classList.contains('edit-mode')) {
          listItem.classList.add('hidden-item');
          listItem.style.opacity = '0.5';
          listItem.style.border = '2px dashed #666';
        }
        
        if (link.li_bg_color) {
          listItem.style.backgroundColor = link.li_bg_color;
        }
        if (link.li_hover_color) {
          listItem.addEventListener('mouseover', () => {
            listItem.style.backgroundColor = link.li_hover_color;
          });
          listItem.addEventListener('mouseout', () => {
            listItem.style.backgroundColor = link.li_bg_color || '';
          });
        }

        let linkContent;

        if (link.default_type === 'nerd-font' && link.icon_class) {
          linkContent = `<a href="${link.url}" style="text-decoration: none; color: ${link.color || 'inherit'}; ${link.background_color ? `background-color: ${link.background_color};` : ''} ${link.border_radius ? `border-radius: ${link.border_radius};` : ''} ${link.font_size ? `font-size: ${link.font_size};` : ''}" ${link.title ? `title="${link.title}"` : ''}><i class="${link.icon_class}"></i></a>`;
        } else if (link.default_type === 'img' && link.img_src) {
          const width = link.width || '50';
          const height = link.height || '50';
          linkContent = `<a href="${link.url}"><img src="${link.img_src}" width="${width}" height="${height}"></a>`;
        } else if (link.default_type === 'text' && link.text) {
          linkContent = `<a href="${link.url}" style="text-decoration: none; color: ${link.color || 'inherit'}; ${link.background_color ? `background-color: ${link.background_color};` : ''} ${link.border_radius ? `border-radius: ${link.border_radius};` : ''} ${link.font_size ? `font-size: ${link.font_size};` : ''}" ${link.title ? `title="${link.title}"` : ''}>${link.text}</a>`;
        } else {
          // Fallback if default_type is not set or doesn't match available content
          if (link.icon_class) {
            linkContent = `<a href="${link.url}" style="text-decoration: none; color: ${link.color || 'inherit'}; ${link.background_color ? `background-color: ${link.background_color};` : ''} ${link.border_radius ? `border-radius: ${link.border_radius};` : ''} ${link.font_size ? `font-size: ${link.font_size};` : ''}" ${link.title ? `title="${link.title}"` : ''}><i class="${link.icon_class}"></i></a>`;
          } else if (link.img_src) {
            const width = link.width || '50';
            const height = link.height || '50';
            linkContent = `<a href="${link.url}"><img src="${link.img_src}" width="${width}" height="${height}"></a>`;
          } else {
            linkContent = `<a href="${link.url}" style="text-decoration: none; color: ${link.color || 'inherit'}; ${link.background_color ? `background-color: ${link.background_color};` : ''} ${link.border_radius ? `border-radius: ${link.border_radius};` : ''} ${link.font_size ? `font-size: ${link.font_size};` : ''}" ${link.title ? `title="${link.title}"` : ''}>${link.name}</a>`;
          }
        }

        listItem.innerHTML = linkContent;

        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'link-buttons';

        // Add reorder buttons
        const reorderButtonsContainer = document.createElement('div');
        reorderButtonsContainer.className = 'reorder-buttons';
        
        const upButton = document.createElement('button');
        upButton.textContent = 'â†‘';
        upButton.className = 'reorder-btn';
        upButton.onclick = (e) => {
          e.stopPropagation();
          moveLink(index, -1);
        };
        reorderButtonsContainer.appendChild(upButton);
        
        const downButton = document.createElement('button');
        downButton.textContent = 'â†“';
        downButton.className = 'reorder-btn';
        downButton.onclick = (e) => {
          e.stopPropagation();
          moveLink(index, 1);
        };
        reorderButtonsContainer.appendChild(downButton);
        
        buttonContainer.appendChild(reorderButtonsContainer);

        const editButton = document.createElement('button');
        editButton.textContent = 'âœï¸';
        editButton.className = 'edit-button';
        editButton.onclick = () => openEditLinkPopup(link, index); // Pass original index
        buttonContainer.appendChild(editButton);

        const deleteButton = document.createElement('button');
        deleteButton.textContent = 'ðŸ—‘ï¸';
        deleteButton.className = 'delete-button';
        deleteButton.onclick = () => deleteLink(index); // Pass original index
        buttonContainer.appendChild(deleteButton);

        listItem.appendChild(buttonContainer);
        groupedElements[groupName].push(listItem);
        groupedLinks[groupName].push({link, index});

        // Check if this group should be collapsible
        if (link.collapsible) {
          collapsibleGroups[groupName] = true;
        }
      });

      // Create collapsible groups container at the top
      const collapsibleGroupNames = Object.keys(collapsibleGroups);
      if (collapsibleGroupNames.length > 0) {
        const collapsibleContainer = document.createElement('div');
        collapsibleContainer.className = 'collapsible-groups-container';
        
        // Create regular row for collapsed groups
        const regularRow = document.createElement('div');
        regularRow.className = 'collapsible-groups-row regular-row';
        
        // Sort groups by their original order in the links array to maintain consistent positioning
        const sortedGroupNames = collapsibleGroupNames.sort((a, b) => {
          const aFirstIndex = links.findIndex(link => (link.group || 'Ungrouped') === a);
          const bFirstIndex = links.findIndex(link => (link.group || 'Ungrouped') === b);
          return aFirstIndex - bFirstIndex;
        });
        
        sortedGroupNames.forEach((groupName, index) => {
          if (groupedElements[groupName] && groupedElements[groupName].length > 0) {
            const collapsibleGroup = createCollapsibleGroup(groupName, groupedElements[groupName], groupedLinks[groupName], index);
            regularRow.appendChild(collapsibleGroup);
          }
        });
        
        collapsibleContainer.appendChild(regularRow);
        linksContainer.appendChild(collapsibleContainer);
      }

      // Now append the regular grouped elements to the container
      const groupNames = Object.keys(groupedElements);
      for (let i = 0; i < groupNames.length; i++) {
        const groupName = groupNames[i];
        
        // Skip collapsible groups as they're already rendered above
        if (collapsibleGroups[groupName]) {
          continue;
        }
        
        // Skip empty groups (when all items are hidden)
        if (groupedElements[groupName].length === 0) {
          continue;
        }

        const groupDiv = createRegularGroup(groupName, groupedElements[groupName], groupedLinks[groupName]);
        linksContainer.appendChild(groupDiv);
      }
    } catch (error) {
      console.error('Error fetching links:', error);
    }
  }

  // Function to create a collapsible group
  function createCollapsibleGroup(groupName, elements, links, originalIndex) {
    const collapsibleGroup = document.createElement('div');
    collapsibleGroup.className = 'collapsible-group';
    collapsibleGroup.dataset.groupName = groupName;
    collapsibleGroup.draggable = true;
    
    // Store original position for proper restoration
    collapsibleGroup.dataset.originalIndex = originalIndex;
    
    // Add drag event listeners for the group itself
    collapsibleGroup.addEventListener('dragstart', handleGroupDragStart);
    collapsibleGroup.addEventListener('dragover', handleGroupDragOver);
    collapsibleGroup.addEventListener('drop', handleGroupDrop);
    collapsibleGroup.addEventListener('dragend', handleGroupDragEnd);
    
    const header = document.createElement('div');
    header.className = 'collapsible-group-header';
    
    const title = document.createElement('h4');
    title.className = 'collapsible-group-title';
    
    // Use custom top name if available, otherwise use group name
    const firstLink = links[0];
    const displayName = (firstLink && firstLink.link.top_name) ? firstLink.link.top_name : groupName;
    title.textContent = displayName;
    
    // Apply custom styling if available
    if (firstLink && firstLink.link) {
      const linkData = firstLink.link;
      
      // Apply background color
      if (linkData.top_bg_color) {
        collapsibleGroup.style.backgroundColor = linkData.top_bg_color;
      }
      
      // Apply text color
      if (linkData.top_text_color) {
        title.style.color = linkData.top_text_color;
      }
      
      // Apply border color
      if (linkData.top_border_color) {
        collapsibleGroup.style.border = `1px solid ${linkData.top_border_color}`;
      }
      
      // Apply hover color
      if (linkData.top_hover_color) {
        collapsibleGroup.addEventListener('mouseenter', () => {
          collapsibleGroup.style.backgroundColor = linkData.top_hover_color;
        });
        collapsibleGroup.addEventListener('mouseleave', () => {
          collapsibleGroup.style.backgroundColor = linkData.top_bg_color || '';
        });
      }
    }
    
    // Add edit buttons container
    const editButtons = document.createElement('div');
    editButtons.className = 'edit-buttons';
    
    const editBtn = document.createElement('button');
    editBtn.className = 'collapsible-edit-btn';
    editBtn.textContent = 'âš™ï¸';
    editBtn.onclick = (e) => {
      e.stopPropagation();
      openEditGroupPopup(groupName);
    };
    editButtons.appendChild(editBtn);
    
    const toggleBtn = document.createElement('button');
    toggleBtn.className = 'collapsible-toggle-btn';
    toggleBtn.textContent = 'â–¼';
    
    header.appendChild(title);
    header.appendChild(editButtons);
    header.appendChild(toggleBtn);
    
    const content = document.createElement('ul');
    content.className = 'collapsible-group-content';
    
    // Create elements for collapsible group with full functionality
    elements.forEach((element, index) => {
      const clonedElement = element.cloneNode(true);
      
      // Re-add drag functionality to cloned elements
      clonedElement.addEventListener('dragstart', handleDragStart);
      clonedElement.addEventListener('dragover', handleDragOver);
      clonedElement.addEventListener('drop', handleDrop);
      clonedElement.addEventListener('dragend', handleDragEnd);
      
      // Keep edit buttons but update their functionality for top groups
      const buttons = clonedElement.querySelector('.link-buttons');
      if (buttons) {
        const editButton = buttons.querySelector('.edit-button');
        const deleteButton = buttons.querySelector('.delete-button');
        
        if (editButton) {
          const originalIndex = parseInt(clonedElement.dataset.linkIndex);
          editButton.onclick = () => openEditLinkPopup(links.find(l => l.index === originalIndex).link, originalIndex);
        }
        
        if (deleteButton) {
          const originalIndex = parseInt(clonedElement.dataset.linkIndex);
          deleteButton.onclick = () => deleteLink(originalIndex);
        }
      }
      
      content.appendChild(clonedElement);
    });
    
    // Add button for adding new links to this collapsible group
    const addLinkItem = document.createElement('li');
    addLinkItem.className = 'link-item add-link-item';

    const addLinkSpan = document.createElement('span');
    addLinkSpan.textContent = '+';
    addLinkSpan.style.cursor = 'pointer';
    addLinkSpan.style.fontFamily = 'jetbrainsmono nfp';
    addLinkSpan.style.fontSize = '25px';
    addLinkSpan.style.alignContent = 'center';

    addLinkSpan.addEventListener('click', () => {
      document.getElementById('link-group').value = groupName === 'Ungrouped' ? '' : groupName;
      const addLinkPopup = document.getElementById('add-link-popup');
      addLinkPopup.classList.remove('hidden'); // Remove hidden class
    });
    addLinkItem.appendChild(addLinkSpan);
    content.appendChild(addLinkItem);
    
    // Add toggle functionality with repositioning
    let isDragging = false;
    let dragTimeout = null;
    
    // Create a more robust drag state management
    const setDragState = (dragging) => {
      isDragging = dragging;
      if (dragging) {
        collapsibleGroup.classList.add('drag-active');
        // Clear any existing timeout
        if (dragTimeout) {
          clearTimeout(dragTimeout);
        }
      } else {
        // Use a longer timeout to ensure drag operations are complete
        dragTimeout = setTimeout(() => {
          isDragging = false;
          collapsibleGroup.classList.remove('drag-active');
        }, 300);
      }
    };
    
    // Track drag state on the content area
    content.addEventListener('dragstart', (e) => {
      setDragState(true);
      e.stopPropagation();
    });
    
    content.addEventListener('dragend', (e) => {
      setDragState(false);
    });
    
    // Prevent all drag-related events from bubbling to header
    content.addEventListener('dragover', (e) => {
      e.preventDefault();
      e.stopPropagation();
    });
    
    content.addEventListener('drop', (e) => {
      e.preventDefault();
      e.stopPropagation();
      // Reset drag state after drop
      setDragState(false);
    });
    
    // Also listen for mouse events during drag to prevent accidental clicks
    content.addEventListener('mousedown', (e) => {
      if (e.target.closest('.link-item')) {
        // Small delay to detect if this is start of a drag
        setTimeout(() => {
          if (document.querySelector('.link-item.dragging')) {
            setDragState(true);
          }
        }, 50);
      }
    });
    
    header.addEventListener('click', (e) => {
      // Don't trigger if clicking on edit button or during drag operations
      if (e.target.classList.contains('collapsible-edit-btn') || 
          isDragging || 
          collapsibleGroup.classList.contains('drag-active')) {
        e.preventDefault();
        e.stopPropagation();
        return false;
      }
      
      const wasExpanded = content.classList.contains('expanded');
      
      // Close all other expanded groups first and properly restore them
      const allGroups = document.querySelectorAll('.collapsible-group');
      const groupsToRestore = [];
      
      allGroups.forEach(group => {
        const groupContent = group.querySelector('.collapsible-group-content');
        const groupToggle = group.querySelector('.collapsible-toggle-btn');
        if (group !== collapsibleGroup) {
          // Always ensure proper state cleanup for all other groups
          groupContent.classList.remove('expanded');
          groupToggle.textContent = 'â–¼';
          group.classList.remove('expanded');
          
          // Collect groups that need to be moved back
          if (group.closest('.expanded-row')) {
            groupsToRestore.push(group);
          }
        }
      });
      
      // Move all groups back to regular row in their original order
      groupsToRestore.forEach(group => {
        moveToRegularRowInOrder(group);
      });
      
      // Clean up empty expanded rows
      cleanupEmptyRows();
      
      // Toggle current group
      content.classList.toggle('expanded');
      toggleBtn.textContent = content.classList.contains('expanded') ? 'â–²' : 'â–¼';
      
      // Move expanded group to top by adding expanded class
      if (content.classList.contains('expanded')) {
        collapsibleGroup.classList.add('expanded');
        // Move to expanded row
        moveToExpandedRow(collapsibleGroup);
      } else {
        collapsibleGroup.classList.remove('expanded');
        // Move back to regular row
        moveToRegularRow(collapsibleGroup);
        // Clean up empty rows after moving
        cleanupEmptyRows();
      }
    });
    
    collapsibleGroup.appendChild(header);
    collapsibleGroup.appendChild(content);
    
    return collapsibleGroup;
  }
  
  // Function to move group to expanded row (top)
  function moveToExpandedRow(group) {
    const container = document.querySelector('.collapsible-groups-container');
    let expandedRow = container.querySelector('.expanded-row');
    
    if (!expandedRow) {
      expandedRow = document.createElement('div');
      expandedRow.className = 'collapsible-groups-row expanded-row';
      container.insertBefore(expandedRow, container.firstChild);
    }
    
    expandedRow.appendChild(group);
  }
  
  // Function to move group back to regular row (maintain original position)
  function moveToRegularRow(group) {
    const container = document.querySelector('.collapsible-groups-container');
    let regularRow = container.querySelector('.regular-row');
    
    if (!regularRow) {
      regularRow = document.createElement('div');
      regularRow.className = 'collapsible-groups-row regular-row';
      container.appendChild(regularRow);
    }
    
    // Get the original index to maintain position
    const originalIndex = parseInt(group.dataset.originalIndex) || 0;
    const existingGroups = Array.from(regularRow.children);
    
    // Find the correct position to insert based on original index
    let insertPosition = 0;
    for (let i = 0; i < existingGroups.length; i++) {
      const existingIndex = parseInt(existingGroups[i].dataset.originalIndex) || 0;
      if (originalIndex < existingIndex) {
        insertPosition = i;
        break;
      }
      insertPosition = i + 1;
    }
    
    // Insert at the correct position
    if (insertPosition >= existingGroups.length) {
      regularRow.appendChild(group);
    } else {
      regularRow.insertBefore(group, existingGroups[insertPosition]);
    }
  }
  
  // Function to move group back to regular row maintaining original order
  function moveToRegularRowInOrder(group) {
    const container = document.querySelector('.collapsible-groups-container');
    let regularRow = container.querySelector('.regular-row');
    
    if (!regularRow) {
      regularRow = document.createElement('div');
      regularRow.className = 'collapsible-groups-row regular-row';
      container.appendChild(regularRow);
    }
    
    // Get the original index to maintain position
    const originalIndex = parseInt(group.dataset.originalIndex) || 0;
    const existingGroups = Array.from(regularRow.children);
    
    // Find the correct position to insert based on original index
    let insertPosition = 0;
    for (let i = 0; i < existingGroups.length; i++) {
      const existingIndex = parseInt(existingGroups[i].dataset.originalIndex) || 0;
      if (originalIndex < existingIndex) {
        insertPosition = i;
        break;
      }
      insertPosition = i + 1;
    }
    
    // Insert at the correct position
    if (insertPosition >= existingGroups.length) {
      regularRow.appendChild(group);
    } else {
      regularRow.insertBefore(group, existingGroups[insertPosition]);
    }
  }

  // Function to clean up empty rows
  function cleanupEmptyRows() {
    const container = document.querySelector('.collapsible-groups-container');
    if (!container) return;
    
    const expandedRows = container.querySelectorAll('.expanded-row');
    expandedRows.forEach(row => {
      if (row.children.length === 0) {
        row.remove();
      }
    });
    
    const regularRows = container.querySelectorAll('.regular-row');
    regularRows.forEach(row => {
      if (row.children.length === 0) {
        row.remove();
      }
    });
  }

  // Function to create a regular group
  function createRegularGroup(groupName, elements, links) {
    const groupDiv = document.createElement('div');
    groupDiv.className = 'link-group';
    groupDiv.dataset.groupName = groupName;

    const groupHeaderContainer = document.createElement('div');
    groupHeaderContainer.className = 'group-header-container';

    const groupTitle = document.createElement('h3');
    groupTitle.textContent = groupName;
    groupTitle.className = 'group-title';
    groupHeaderContainer.appendChild(groupTitle);

    // Add group reorder buttons
    const groupReorderButtons = document.createElement('div');
    groupReorderButtons.className = 'group-reorder-buttons';
    
    const groupUpButton = document.createElement('button');
    groupUpButton.textContent = 'â†‘';
    groupUpButton.className = 'reorder-btn';
    groupUpButton.onclick = (e) => {
      e.stopPropagation();
      moveGroup(groupName, -1);
    };
    groupReorderButtons.appendChild(groupUpButton);
    
    const groupDownButton = document.createElement('button');
    groupDownButton.textContent = 'â†“';
    groupDownButton.className = 'reorder-btn';
    groupDownButton.onclick = (e) => {
      e.stopPropagation();
      moveGroup(groupName, 1);
    };
    groupReorderButtons.appendChild(groupDownButton);
    
    groupHeaderContainer.appendChild(groupReorderButtons);

    // Add edit group button (only visible in edit mode)
    const editGroupButton = document.createElement('button');
    editGroupButton.textContent = 'âš™ï¸';
    editGroupButton.className = 'edit-group-button';
    editGroupButton.onclick = () => openEditGroupPopup(groupName);
    groupHeaderContainer.appendChild(editGroupButton);

    groupDiv.appendChild(groupHeaderContainer);

    const groupList = document.createElement('ul');
    groupList.className = 'link-group-content';
    // Set display style based on the first link in the group, or default to flex
    const firstLinkInGroup = links[0];
    if (firstLinkInGroup && firstLinkInGroup.link.display_style) {
      groupList.style.display = firstLinkInGroup.link.display_style;
    } else {
      groupList.style.display = 'flex'; // Default display style
    }

    elements.forEach(element => {
      groupList.appendChild(element);
    });

    // Add button for adding new links to this group
    const addLinkItem = document.createElement('li');
    addLinkItem.className = 'link-item add-link-item';

    const addLinkSpan = document.createElement('span');
    addLinkSpan.textContent = '+';
    addLinkSpan.style.cursor = 'pointer';
    addLinkSpan.style.fontFamily = 'jetbrainsmono nfp';
    addLinkSpan.style.fontSize = '25px';
    addLinkSpan.style.alignContent = 'center';

    addLinkSpan.addEventListener('click', () => {
      document.getElementById('link-group').value = groupName === 'Ungrouped' ? '' : groupName;
      const addLinkPopup = document.getElementById('add-link-popup');
      addLinkPopup.classList.remove('hidden'); // Remove hidden class
    });
    addLinkItem.appendChild(addLinkSpan);
    groupList.appendChild(addLinkItem);

    groupDiv.appendChild(groupList);
    return groupDiv;
  }  
// Function to open edit group popup
  function openEditGroupPopup(currentGroupName) {
    const editGroupPopup = document.getElementById('edit-group-popup');
    const editGroupNameInput = document.getElementById('edit-group-name');
    const editGroupOriginalName = document.getElementById('edit-group-original-name');
    const editGroupDisplaySelect = document.getElementById('edit-group-display');
    const editGroupCollapsibleCheckbox = document.getElementById('edit-group-collapsible');
    const editGroupTopNameInput = document.getElementById('edit-group-top-name');
    const editGroupTopBgColorInput = document.getElementById('edit-group-top-bg-color');
    const editGroupTopTextColorInput = document.getElementById('edit-group-top-text-color');
    const editGroupTopBorderColorInput = document.getElementById('edit-group-top-border-color');
    const editGroupTopHoverColorInput = document.getElementById('edit-group-top-hover-color');
    const collapsibleRenameSection = document.getElementById('collapsible-rename-section');

    editGroupNameInput.value = currentGroupName === 'Ungrouped' ? '' : currentGroupName;
    editGroupOriginalName.value = currentGroupName;

    // Find a link in the current group to get its display_style, collapsible setting, and styling options
    const linksInGroup = links.filter(link => (link.group || 'Ungrouped') === currentGroupName);
    if (linksInGroup.length > 0) {
      editGroupDisplaySelect.value = linksInGroup[0].display_style || 'flex';
      editGroupCollapsibleCheckbox.checked = linksInGroup[0].collapsible || false;
      editGroupTopNameInput.value = linksInGroup[0].top_name || '';
      editGroupTopBgColorInput.value = linksInGroup[0].top_bg_color || '#2d2d2d';
      editGroupTopTextColorInput.value = linksInGroup[0].top_text_color || '#ffffff';
      editGroupTopBorderColorInput.value = linksInGroup[0].top_border_color || '#444444';
      editGroupTopHoverColorInput.value = linksInGroup[0].top_hover_color || '#3a3a3a';
    } else {
      editGroupDisplaySelect.value = 'flex'; // Default if no links in group
      editGroupCollapsibleCheckbox.checked = false;
      editGroupTopNameInput.value = '';
      editGroupTopBgColorInput.value = '#2d2d2d';
      editGroupTopTextColorInput.value = '#ffffff';
      editGroupTopBorderColorInput.value = '#444444';
      editGroupTopHoverColorInput.value = '#3a3a3a';
    }

    // Show/hide the rename section based on collapsible checkbox
    function toggleRenameSection() {
      if (editGroupCollapsibleCheckbox.checked) {
        collapsibleRenameSection.style.display = 'block';
      } else {
        collapsibleRenameSection.style.display = 'none';
      }
    }

    // Initial toggle
    toggleRenameSection();

    // Add event listener for checkbox changes
    editGroupCollapsibleCheckbox.addEventListener('change', toggleRenameSection);

    editGroupPopup.classList.remove('hidden');
  }

  // Drag and Drop functionality for collapsible groups
  let draggedGroup = null;

  function handleGroupDragStart(e) {
    draggedGroup = this;
    this.style.opacity = '0.5';
    e.dataTransfer.effectAllowed = 'move';
    e.dataTransfer.setData('text/html', this.outerHTML);
  }

  function handleGroupDragOver(e) {
    if (e.preventDefault) {
      e.preventDefault();
    }
    e.dataTransfer.dropEffect = 'move';
    return false;
  }

  function handleGroupDrop(e) {
    if (e.stopPropagation) {
      e.stopPropagation();
    }
    
    if (draggedGroup !== this) {
      const draggedGroupName = draggedGroup.dataset.groupName;
      const targetGroupName = this.dataset.groupName;
      swapCollapsibleGroups(draggedGroupName, targetGroupName);
    }
    return false;
  }

  function handleGroupDragEnd(e) {
    this.style.opacity = '';
    draggedGroup = null;
  }

  // Function to swap collapsible groups
  async function swapCollapsibleGroups(group1Name, group2Name) {
    try {
      const response = await fetch('/api/links');
      const links = await response.json();
      
      // Find all links in both groups
      const group1Links = [];
      const group2Links = [];
      const otherLinks = [];
      
      links.forEach((link, index) => {
        const linkGroup = link.group || 'Ungrouped';
        if (linkGroup === group1Name) {
          group1Links.push({link, index});
        } else if (linkGroup === group2Name) {
          group2Links.push({link, index});
        } else {
          otherLinks.push({link, index});
        }
      });
      
      // Create new links array with swapped group positions
      const newLinks = [];
      
      // Add other groups first (maintain their positions)
      const processedGroups = new Set([group1Name, group2Name]);
      const groupOrder = [...new Set(links.map(link => link.group || 'Ungrouped'))];
      
      groupOrder.forEach(groupName => {
        if (groupName === group1Name) {
          group2Links.forEach(item => newLinks.push(item.link));
        } else if (groupName === group2Name) {
          group1Links.forEach(item => newLinks.push(item.link));
        } else {
          const groupLinks = links.filter(link => (link.group || 'Ungrouped') === groupName);
          groupLinks.forEach(link => newLinks.push(link));
        }
      });
      
      // Update the entire list of links on the server
      await fetch('/api/links', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(newLinks),
      });
      
      fetchAndDisplayLinks();
      
    } catch (error) {
      console.error('Error swapping collapsible groups:', error);
    }
  }

  // Function to update group name for all links in that group
  async function updateGroupName(originalGroupName, newGroupName, newDisplayStyle, isCollapsible, topName, topBgColor, topTextColor, topBorderColor, topHoverColor) {
    try {
      const response = await fetch('/api/links');
      const links = await response.json();
      
      // Create a new array with the updated group names, display styles, collapsible setting, and styling options
      const newLinks = links.map(link => {
        const linkGroupName = link.group || 'Ungrouped';
        if (linkGroupName === originalGroupName) {
          const updatedLink = { ...link };
          if (newGroupName && newGroupName !== '') {
            updatedLink.group = newGroupName;
          } else {
            delete updatedLink.group; // For "Ungrouped"
          }
          updatedLink.display_style = newDisplayStyle;
          updatedLink.collapsible = isCollapsible;
          
          // Handle top group styling options
          if (topName && topName !== '') {
            updatedLink.top_name = topName;
          } else {
            delete updatedLink.top_name;
          }
          
          if (topBgColor && topBgColor !== '') {
            updatedLink.top_bg_color = topBgColor;
          } else {
            delete updatedLink.top_bg_color;
          }
          
          if (topTextColor && topTextColor !== '') {
            updatedLink.top_text_color = topTextColor;
          } else {
            delete updatedLink.top_text_color;
          }
          
          if (topBorderColor && topBorderColor !== '') {
            updatedLink.top_border_color = topBorderColor;
          } else {
            delete updatedLink.top_border_color;
          }
          
          if (topHoverColor && topHoverColor !== '') {
            updatedLink.top_hover_color = topHoverColor;
          } else {
            delete updatedLink.top_hover_color;
          }
          
          return updatedLink;
        }
        return link;
      });

      // Update the entire list on the server
      const updateResponse = await fetch('/api/links', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(newLinks),
      });

      if (!updateResponse.ok) {
        throw new Error('Failed to update links on the server.');
      }

      return true;
    } catch (error) {
      console.error('Error updating group name:', error);
      return false;
    }
  }

  // Handle form submission for adding new links
  if (addLinkForm) {
    addLinkForm.addEventListener('submit', async function(event) {
      event.preventDefault();

      const newLink = {
        name: document.getElementById('link-name').value,
        group: document.getElementById('link-group').value || undefined,
        url: document.getElementById('link-url').value,
        icon_class: document.getElementById('link-icon-class').value || undefined,
        color: document.getElementById('link-color').value || undefined,
        img_src: document.getElementById('link-img-src').value || undefined,
        text: document.getElementById('link-text').value || undefined,
        default_type: document.getElementById('link-default-type').value || undefined,
        background_color: document.getElementById('link-background-color').value || undefined,
        border_radius: document.getElementById('link-border-radius').value || undefined,
        font_size: document.getElementById('link-font-size').value || undefined,
        title: document.getElementById('link-title').value || undefined,
        li_bg_color: document.getElementById('link-li-bg-color').value || undefined,
        li_hover_color: document.getElementById('link-li-hover-color').value || undefined,
        hidden: document.getElementById('link-hidden').checked || undefined,
      };

      // Clean up empty strings and false values for optional fields
      Object.keys(newLink).forEach(key => {
        if (newLink[key] === '' || newLink[key] === false) {
          delete newLink[key];
        }
      });

      try {
        const response = await fetch('/api/add_link', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(newLink),
        });

        if (response.ok) {
          alert('Link added successfully!');
          addLinkForm.reset(); // Clear form
          fetchAndDisplayLinks(); // Refresh links
        } else {
          alert('Failed to add link.');
        }
      } catch (error) {
        console.error('Error adding link:', error);
        alert('Error adding link.');
      }
    });
  }

  // Edit Link functionality
  const editLinkPopup = document.getElementById('edit-link-popup');
  const editLinkForm = document.getElementById('edit-link-form');
  const editLinkIndexInput = document.getElementById('edit-link-index');

  function openEditLinkPopup(link, index) {
    editLinkIndexInput.value = index;
    document.getElementById('edit-link-name').value = link.name || '';
    document.getElementById('edit-link-group').value = link.group || '';
    document.getElementById('edit-link-url').value = link.url || '';
    document.getElementById('edit-link-icon-class').value = link.icon_class || '';
    document.getElementById('edit-link-color').value = link.color || '';
    document.getElementById('edit-link-img-src').value = link.img_src || '';
    document.getElementById('edit-link-width').value = link.width || '';
    document.getElementById('edit-link-height').value = link.height || '';
    document.getElementById('edit-link-text').value = link.text || '';
    document.getElementById('edit-link-default-type').value = link.default_type || 'nerd-font';
    document.getElementById('edit-link-background-color').value = link.background_color || '';
    document.getElementById('edit-link-border-radius').value = link.border_radius || '';
    document.getElementById('edit-link-title').value = link.title || '';
    document.getElementById('edit-link-font-size').value = link.font_size || '';
    document.getElementById('edit-link-li-bg-color').value = link.li_bg_color || '';
    document.getElementById('edit-link-li-hover-color').value = link.li_hover_color || '';
    document.getElementById('edit-link-hidden').checked = link.hidden || false;
    editLinkPopup.classList.remove('hidden');
  }

  if (editLinkForm) {
    if (!editLinkForm.hasAttribute('data-listener-attached')) {
        editLinkForm.addEventListener('submit', async function(event) {
            event.preventDefault();

            const linkId = editLinkIndexInput.value;
            const updatedLink = {
                name: document.getElementById('edit-link-name').value,
                group: document.getElementById('edit-link-group').value || undefined,
                url: document.getElementById('edit-link-url').value,
                icon_class: document.getElementById('edit-link-icon-class').value || undefined,
                color: document.getElementById('edit-link-color').value || undefined,
                img_src: document.getElementById('edit-link-img-src').value || undefined,
                width: document.getElementById('edit-link-width').value || undefined,
                height: document.getElementById('edit-link-height').value || undefined,
                text: document.getElementById('edit-link-text').value || undefined,
                default_type: document.getElementById('edit-link-default-type').value || undefined,
                background_color: document.getElementById('edit-link-background-color').value || undefined,
                border_radius: document.getElementById('edit-link-border-radius').value || undefined,
                title: document.getElementById('edit-link-title').value || undefined,
                font_size: document.getElementById('edit-link-font-size').value || undefined,
                li_bg_color: document.getElementById('edit-link-li-bg-color').value || undefined,
                li_hover_color: document.getElementById('edit-link-li-hover-color').value || undefined,
                hidden: document.getElementById('edit-link-hidden').checked || undefined,
            };

            // Clean up empty strings and false values for optional fields
            Object.keys(updatedLink).forEach(key => {
                if (updatedLink[key] === '' || updatedLink[key] === false) {
                    delete updatedLink[key];
                }
            });

            try {
                const response = await fetch(`/api/links/${linkId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(updatedLink),
                });

                if (response.ok) {
                    editLinkPopup.classList.add('hidden');
                    fetchAndDisplayLinks();
                } else {
                    alert('Failed to update link.');
                }
            } catch (error) {
                console.error('Error updating link:', error);
                alert('Error updating link.');
            }
        });
        editLinkForm.setAttribute('data-listener-attached', 'true');
    }
  }

  // Edit Group functionality
  const editGroupForm = document.getElementById('edit-group-form');
  if (editGroupForm) {
    if (!editGroupForm.hasAttribute('data-listener-attached')) {
      editGroupForm.addEventListener('submit', async function(event) {
        event.preventDefault();

        const originalGroupName = document.getElementById('edit-group-original-name').value;
        const newGroupName = document.getElementById('edit-group-name').value;
        const newDisplayStyle = document.getElementById('edit-group-display').value;
        const isCollapsible = document.getElementById('edit-group-collapsible').checked;
        const topName = document.getElementById('edit-group-top-name').value;
        const topBgColor = document.getElementById('edit-group-top-bg-color').value;
        const topTextColor = document.getElementById('edit-group-top-text-color').value;
        const topBorderColor = document.getElementById('edit-group-top-border-color').value;
        const topHoverColor = document.getElementById('edit-group-top-hover-color').value;

        try {
          const success = await updateGroupName(originalGroupName, newGroupName, newDisplayStyle, isCollapsible, topName, topBgColor, topTextColor, topBorderColor, topHoverColor);
          if (success) {
            document.getElementById('edit-group-popup').classList.add('hidden');
            fetchAndDisplayLinks();
          } else {
            alert('Failed to update group settings.');
          }
        } catch (error) {
          console.error('Error updating group settings:', error);
          alert('Error updating group settings.');
        }
      });
      editGroupForm.setAttribute('data-listener-attached', 'true');
    }
  }

  // Delete Link functionality
  async function deleteLink(linkId) {
    if (confirm('Are you sure you want to delete this link?')) {
      try {
        const response = await fetch(`/api/links/${linkId}`, {
          method: 'DELETE',
        });

        if (response.ok) {
          alert('Link deleted successfully!');
          fetchAndDisplayLinks();
        } else {
          alert('Failed to delete link.');
        }
      } catch (error) {
        console.error('Error deleting link:', error);
        alert('Error deleting link.');
      }
    }
  }

  // Initial fetch and display of links
  fetchAndDisplayLinks();

  // Edit Mode Toggle functionality
  const editModeToggle = document.getElementById('edit-mode-toggle');
  const flexContainer2 = document.querySelector('.flex-container2');

  if (editModeToggle && flexContainer2) {
    editModeToggle.addEventListener('change', function() {
      if (this.checked) {
        flexContainer2.classList.add('edit-mode');
      } else {
        flexContainer2.classList.remove('edit-mode');
      }
      // Refresh the display when edit mode is toggled to show/hide items
      fetchAndDisplayLinks();
    });
  }

  // Drag and Drop functionality for links
  let draggedElement = null;
  let draggedIndex = null;

  function handleDragStart(e) {
    draggedElement = this;
    draggedIndex = parseInt(this.dataset.linkIndex);
    this.classList.add('dragging');
    e.dataTransfer.effectAllowed = 'move';
    e.dataTransfer.setData('text/html', this.outerHTML);
    e.stopPropagation(); // Prevent bubbling to group header
    
    // Disable group toggle during drag
    document.body.classList.add('dragging-active');
  }

  function handleDragOver(e) {
    if (e.preventDefault) {
      e.preventDefault();
    }
    e.dataTransfer.dropEffect = 'move';
    return false;
  }

  function handleDrop(e) {
    if (e.stopPropagation) {
      e.stopPropagation();
    }
    
    if (draggedElement !== this) {
      const targetIndex = parseInt(this.dataset.linkIndex);
      swapLinks(draggedIndex, targetIndex);
    }
    return false;
  }

  function handleDragEnd(e) {
    this.classList.remove('dragging');
    draggedElement = null;
    draggedIndex = null;
    
    // Re-enable group toggle after drag
    document.body.classList.remove('dragging-active');
  }

  // Move link up or down within the same group
  async function moveLink(linkIndex, direction) {
    try {
      const response = await fetch('/api/links');
      const links = await response.json();
      
      const currentLink = links[linkIndex];
      const currentGroup = currentLink.group || 'Ungrouped';
      
      // Find all links in the same group
      const groupLinks = links.map((link, index) => ({link, index}))
                              .filter(item => (item.link.group || 'Ungrouped') === currentGroup);
      
      // Find current position within the group
      const currentGroupIndex = groupLinks.findIndex(item => item.index === linkIndex);
      const targetGroupIndex = currentGroupIndex + direction;
      
      // Check bounds
      if (targetGroupIndex < 0 || targetGroupIndex >= groupLinks.length) {
        return;
      }
      
      // Swap with target
      const targetLinkIndex = groupLinks[targetGroupIndex].index;
      await swapLinks(linkIndex, targetLinkIndex);
      
    } catch (error) {
      console.error('Error moving link:', error);
    }
  }

  // Move entire group up or down
  async function moveGroup(groupName, direction) {
    try {
      const response = await fetch('/api/links');
      const links = await response.json();
      
      // Get all unique group names in their current order
      const groupNames = [...new Set(links.map(link => link.group || 'Ungrouped'))];
      const currentIndex = groupNames.indexOf(groupName);
      const targetIndex = currentIndex + direction;
      
      // Check bounds
      if (targetIndex < 0 || targetIndex >= groupNames.length) {
        return;
      }
      
      // Swap the group names
      [groupNames[currentIndex], groupNames[targetIndex]] = [groupNames[targetIndex], groupNames[currentIndex]];
      
      // Rebuild the links array based on the new group order
      const newLinks = [];
      const linksByGroup = links.reduce((acc, link) => {
        const group = link.group || 'Ungrouped';
        if (!acc[group]) {
          acc[group] = [];
        }
        acc[group].push(link);
        return acc;
      }, {});
      
      groupNames.forEach(group => {
        newLinks.push(...(linksByGroup[group] || []));
      });
      
      // Update the entire list of links on the server
      await fetch('/api/links', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(newLinks),
      });
      
      fetchAndDisplayLinks();
      
    } catch (error) {
      console.error('Error moving group:', error);
    }
  }

  // Swap two links by their indices
  async function swapLinks(index1, index2) {
    try {
      const response = await fetch('/api/links');
      const links = await response.json();
      
      // Swap the links
      [links[index1], links[index2]] = [links[index2], links[index1]];
      
      // Update both links
      await fetch(`/api/links/${index1}`, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(links[index1]),
      });
      
      await fetch(`/api/links/${index2}`, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(links[index2]),
      });
      
      fetchAndDisplayLinks();
      
    } catch (error) {
      console.error('Error swapping links:', error);
    }
  }
});

// Functions from original index.js
function updateSearchEngine() {
  var selectedEngine = document.getElementById('search-engine').value;
  document.getElementById('current-search-engine').textContent = selectedEngine;
}

function checkEnter(event) {
  if (event.key === 'Enter') {
    search();
  }
}

function search() {
  var query = document.getElementById('searchQuery').value;
  var selectedEngine = document.getElementById('search-engine').value;

  if (query) {
    window.location.href = 'https://' + selectedEngine + '.com/search?q=' + encodeURIComponent(query);
  }
}

function updateDateTime() {
  const now = new Date();
  const optionsDate = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
  const optionsTime = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true };
  document.getElementById('currentDate').innerText = now.toLocaleDateString('en-US', optionsDate);
  document.getElementById('currentTime').innerText = now.toLocaleTimeString('en-US', optionsTime);
}

// Update the date and time on page load
updateDateTime();

// Update the time every second
setInterval(updateDateTime, 1000);
    
    // Disable edit functionality in static version
    document.addEventListener('DOMContentLoaded', function() {
      // Hide edit toggle
      const editToggle = document.querySelector('.toggle-container');
      if (editToggle) {
        editToggle.style.display = 'none';
      }
      
      // Remove edit buttons and functionality
      const style = document.createElement('style');
      style.textContent = `
        .edit-button, .delete-button, .add-link-item, .edit-group-button, .collapsible-edit-btn {
          display: none !important;
        }
        .link-item {
          cursor: default !important;
        }
        .collapsible-group {
          cursor: default !important;
        }
      `;
      document.head.appendChild(style);
    });
  </script>

  </div>
  
  <!-- Generated on 2025-07-25 09:40:17 -->
</body>
</html>