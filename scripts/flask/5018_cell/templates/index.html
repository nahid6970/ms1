<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel-like Data Table</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Cell Context Menu -->
    <div id="cellContextMenu" class="context-menu">
        <div class="context-menu-item" id="ctxBold" onclick="toggleCellBold()">
            <span class="checkmark">‚úì</span>
            <span>Bold</span>
        </div>
        <div class="context-menu-item" id="ctxItalic" onclick="toggleCellItalic()">
            <span class="checkmark">‚úì</span>
            <span>Italic</span>
        </div>
        <div class="context-menu-item" id="ctxCenter" onclick="toggleCellCenter()">
            <span class="checkmark">‚úì</span>
            <span>Center Align</span>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" id="ctxMerge" onclick="mergeCells()">
            <span>‚äû</span>
            <span>Merge Cells</span>
        </div>
        <div class="context-menu-item" id="ctxUnmerge" onclick="unmergeCell()">
            <span>‚äü</span>
            <span>Unmerge Cell</span>
        </div>
    </div>

    <div class="container">
        <div class="sheet-tabs">
            <button onclick="addSheet()" class="btn-add-sheet" title="Add Sheet">+</button>
            
            <div class="sheet-controls">
                <div class="sheet-selector">
                    <button class="sheet-current" id="currentSheetBtn" onclick="toggleSheetList()">
                        <span id="currentSheetName">Sheet1</span>
                        <span class="dropdown-arrow">‚ñº</span>
                    </button>
                    <div class="sheet-list" id="sheetList"></div>
                </div>
                
                <button onclick="showRenameModal(currentSheet)" class="btn-sheet-action" title="Rename Sheet">
                    <span>‚úèÔ∏è</span>
                </button>
                <button onclick="deleteSheet(currentSheet)" class="btn-sheet-action btn-delete" title="Delete Sheet">
                    <span>üóëÔ∏è</span>
                </button>
            </div>

            <button onclick="openSettings()" class="btn-settings" title="Settings">
                <span>‚öôÔ∏è</span>
            </button>
        </div>

        <div class="toolbar">
            <button onclick="addColumn()" class="btn btn-primary">Add Column</button>
            <button onclick="addRow()" class="btn btn-primary">Add Row</button>
            <button onclick="saveData()" class="btn btn-success">Save Data</button>
            <button onclick="loadData()" class="btn btn-info">Refresh</button>
        </div>

        <div class="table-container">
            <table id="dataTable">
                <thead id="tableHead">
                    <tr id="headerRow"></tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>

    <!-- Column Settings Modal -->
    <div id="columnModal" class="modal">
        <div class="modal-content column-modal">
            <div class="modal-header">
                <h2 id="columnModalTitle">Add Column</h2>
                <span class="close" onclick="closeColumnModal()">&times;</span>
            </div>
            <form id="columnForm">
                <input type="hidden" id="editingColumnIndex" value="-1">
                
                <div class="form-group">
                    <label for="columnName">Column Name</label>
                    <input type="text" id="columnName" class="form-input" placeholder="Enter column name" required autofocus>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="columnType">Data Type</label>
                        <select id="columnType" class="form-input">
                            <option value="text">Text</option>
                            <option value="number">Number</option>
                            <option value="date">Date</option>
                            <option value="email">Email</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="columnFont">Font</label>
                        <select id="columnFont" class="form-input">
                            <option value="">Default</option>
                            <option value="JetBrains Mono">JetBrains Mono</option>
                            <option value="Arial">Arial</option>
                            <option value="Courier New">Courier New</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Times New Roman">Times New Roman</option>
                            <option value="Verdana">Verdana</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="columnWidth">Width (px)</label>
                    <input type="number" id="columnWidth" class="form-input" value="150" min="50">
                </div>
                
                <div class="form-group">
                    <label for="columnColor">Background Color</label>
                    <div class="color-picker-wrapper">
                        <input type="color" id="columnColor" class="color-input" value="#ffffff">
                        <input type="text" id="columnColorText" class="form-input color-text" value="#FFFFFF" readonly>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="columnTextColor">Text Color</label>
                    <div class="color-picker-wrapper">
                        <input type="color" id="columnTextColor" class="color-input" value="#000000">
                        <input type="text" id="columnTextColorText" class="form-input color-text" value="#000000" readonly>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeColumnModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="columnSubmitBtn">Add Column</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Rename Sheet Modal -->
    <div id="renameModal" class="modal">
        <div class="modal-content rename-modal">
            <div class="modal-header">
                <h2>Rename Sheet</h2>
                <span class="close" onclick="closeRenameModal()">&times;</span>
            </div>
            <form id="renameForm">
                <div class="form-group">
                    <label for="sheetName">Sheet Name</label>
                    <input type="text" id="sheetName" class="form-input" placeholder="Enter sheet name" required autofocus>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeRenameModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Rename</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content settings-modal">
            <div class="modal-header">
                <h2>Settings</h2>
                <span class="close" onclick="closeSettingsModal()">&times;</span>
            </div>
            <div class="settings-content">
                <p style="text-align: center; color: #6c757d; padding: 40px 20px;">
                    Settings features will be added here in future updates.
                </p>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
