<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameARR</title>

    <style>
        @import url("https://www.nerdfonts.com/assets/css/webfont.css");
        body { font-family: Arial, sans-serif; background: #1c1c1c; color: white; text-align: center; }
        .container { margin: auto; padding: 20px; }
        .game-list {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        padding: 20px;
        justify-content: center; /* Center items if they don’t fill the row */
        align-items: flex-start; /* Align items at the top */
        }
        .game {
        font-family: JetBrainsMono NFP, sans-serif;
        width: 325px;
        background-color: #404357;
        /* width: 20%; */
        flex: 0 0 auto;
        transition: transform 0.3s ease, box-shadow 0.3s ease; /* Smooth transform and shadow */
        }
        .game:hover {
        transform: scale(1.05); /* Slight zoom effect */
        border: 2px solid rgb(24, 255, 3); /* Add a 2px solid white border on hover */
        border-radius: 5px;
        box-shadow: none; /* Remove the shadow if you prefer no shadow at all */
        background-color: #485461;
        }

.game .img-wrapper {
margin-top: 3%;
width: 100%;
aspect-ratio: 16 / 16; /* or fixed height like height: 200px; */
background-color: rgba(45, 116, 128, 0);
border-radius: 10px;
overflow: hidden;
padding-top: 1px;
padding-bottom: 1px;
padding-left: 0px;
padding-right: 0px;
}
.game .img-wrapper img {
width: 100%;
height: 100%;
object-fit: contain; /* or 'cover' if you want to crop */
border-radius: 10px;
display: block;
}
        .game h2 { font-size: 1.5em; color: #e0e0e0; margin-top: 10px; height: 2.5em; align-content: center;}
        .game p { font-size: 1.2em; color: gold; }

        .form-container { display: none; background: #333; padding: 10px; border-radius: 10px; margin: 20px auto; }
        input { margin: 5px; padding: 8px; width: 90%; }

.btn-group {
display: flex;
justify-content: center; /* <-- centers horizontally */
gap: 8px; /* Consistent gap between buttons */
margin-top: 0px;
}
.btn { margin: 2px; padding: 8px 10px; border: none; cursor: pointer; border-radius: 5px; }
.btn-add { background: #28a745; color: white; }
div.form-container{
    max-width: 50%;
}

.btn-edit {  color: white; text-decoration: none; border: 2px solid;}
.btn-edit:hover { background: #007bff; color: white; }

.btn-delete { color:  rgb(255, 0, 0); text-decoration: none; border: 2px solid red; }
.btn-delete:hover { background: #ff0019; color: rgb(255, 254, 254); }

.btn-ytreview {  color: rgb(253, 38, 38); text-decoration: none; border: 2px solid white; }
.btn-ytreview:hover { background: #dc3545; color: white; }

        .top-controls { margin-bottom: 20px; }
        .top-controls button, .top-controls .sort-btn {
        background: #28a745;
        color: white;
        padding: 10px 14px;
        margin: 0 5px;
        border: none;
        border-radius: 4px;
        text-decoration: none;
        font-weight: bold;
        transition: transform 0.2s, background 0.2s;
        }
        .top-controls .sort-btn {
        background: #ffc936;
        color: rgb(0, 0, 0);
        padding: 10px 14px;
        margin: 0 5px;
        border: none;
        border-radius: 4px;
        text-decoration: none;
        font-weight: bold;
        transition: transform 0.2s, background 0.2s;
        }
        .top-controls .sort-btn:hover,
        .top-controls button:hover {
        transform: scale(1.05);
        background: #218838;
        }


        .progression-group {
        margin-bottom: 15px;
        display: flex; /* Enable flexbox */
        justify-content: center; /* Center items horizontally */
        align-items: center; /* Center items vertically (optional, but can be useful) */
    }
    .progression-group label {
        margin-right: 10px;
    }
    .progression-group input[type="radio"] {
        display: none;
    }
    .progression-group label span {
        padding: 8px 15px;
        border: 1px solid #555;
        border-radius: 5px;
        cursor: pointer;
        background-color: #444;
        color: white;
        display: inline-block;
        min-width: 90px;
        text-align: center;
    }
    .progression-group input[type="radio"]:checked + span {
        background-color: #28a745; /* Green for selected progression */
        border-color: #28a745;
    }

    /* Style for the rating radio button group */
    .rating-group {
        margin-top: 20px;
        margin-bottom: 0px;
        display: flex; /* Enable flexbox */
        justify-content: center; /* Center items horizontally */
        align-items: center; /* Center items vertically (optional) */
    }
    .rating-group label {
        margin-right: 10px;
    }
    .rating-group input[type="radio"] {
        display: none;
    }
    .rating-group label span {
        padding: 8px 15px;
        border: 1px solid #555;
        border-radius: 15px;
        cursor: pointer;
        background-color: #444;
        color: white;
        display: inline-block;
        min-width: 30px; /* Smaller width for rating numbers */
        text-align: center;
    }
    .rating-group input[type="radio"]:checked + span {
        background-color: gold; /* Gold for selected rating */
        border-color: gold;
        color: black; /* Ensure text is readable on gold */
    }

.collection-filter {
margin-top: 10px;
}
.collection-filter select {
padding: 8px;
border-radius: 4px;
border: 1px solid #555;
background-color: #333;
color: white;
}

        </style>


<script>
    function toggleForm() {
        var form = document.getElementById("gameForm");
        form.style.display = (form.style.display === "none" || form.style.display === "") ? "block" : "none";
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Restore scroll position on page load
        if (sessionStorage.getItem('scrollPosition') !== null) {
            window.scrollTo(0, sessionStorage.getItem('scrollPosition'));
            sessionStorage.removeItem('scrollPosition');
        }
    });

    window.addEventListener('beforeunload', function() {
        // Save scroll position before refresh
        sessionStorage.setItem('scrollPosition', window.scrollY);
    });

        // ... existing JavaScript ...
        function googleSearch() {
        const gameNameInput = document.getElementById('gameName');
        const gameName = gameNameInput.value;
        if (gameName) {
            const googleSearchUrl = `https://www.google.com/search?q=${encodeURIComponent(gameName)}`;
            window.open(googleSearchUrl, '_blank');
        } else {
            alert('Please enter a game name first.');
        }
    }

    function filterByCollection(collection) {
        window.location.href = '/?collection=' + collection;
    }
</script>

</head>
<body>
    <div class="container">
        <a href="/" style="text-decoration: none; color: white;"><h1>GameARR</h1></a>
        <div class="top-controls">
            <button onclick="toggleForm()">Add Game</button>
            <a href="/?sort_by=name&order={{ next_order }}{% if query %}&query={{ query }}{% endif %}{% if current_collection_filter %}&collection={{ current_collection_filter }}{% endif %}" class="sort-btn"><i class="nf nf-fa-sort_alpha_asc"></i></a>
            <a href="/?sort_by=year&order={{ next_order }}{% if query %}&query={{ query }}{% endif %}{% if current_collection_filter %}&collection={{ current_collection_filter }}{% endif %}" class="sort-btn"><i class="nf nf-md-sort_calendar_ascending"></i></a>
            <a href="/?sort_by=rating&order={{ next_order }}{% if query %}&query={{ query }}{% endif %}{% if current_collection_filter %}&collection={{ current_collection_filter }}{% endif %}" class="sort-btn"><i class="nf nf-fa-star"></i></a>
            <a href="/?sort_by=added&order={{ next_order }}{% if query %}&query={{ query }}{% endif %}{% if current_collection_filter %}&collection={{ current_collection_filter }}{% endif %}" class="sort-btn"><i class="nf nf-fa-sort_numeric_asc"></i></a>

            <form action="/search" method="get" style="display: inline;">
                <input type="text" name="query" placeholder="Search Games" style="width: 250px;" value="{{ query if query }}">
                <button type="submit" class="btn">Search</button>
            </form>
            <button disabled>Total Games: {{ total_games }}</button> </div>
            <div class="collection-filter">
                <select onchange="filterByCollection(this.value)">
                    <option value="">All Collections</option>
                    {% for collection in collections %}
                        <option value="{{ collection }}" {% if collection == current_collection_filter %}selected{% endif %}>{{ collection }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="form-container" id="gameForm">
            <form action="/add?sort_by={{ sort_by }}&order={{ order }}{% if current_collection_filter %}&collection={{ current_collection_filter }}{% endif %}" method="post">
                <div style="display: flex; align-items: center; margin-bottom: -15px; justify-content: center;">
                    <input type="text" id="gameName" name="name" placeholder="Game Name" required style="flex-grow: 1; max-width: 65%; text-align: center; font-size: 1.25rem; font-family:JetBrainsMono NFP, sans-serif;">
                    <button type="button" class="btn" onclick="googleSearch()"><i class="nf nf-dev-google"></i></button><!-- Added Google Search button -->
                </div><br>
                <input type="text" name="image" placeholder="Image URL" style="background-color: #f7fa4f; "><br>
                <input type="text" name="url" placeholder="Game URL" style="background-color: #f7fa4f;" ><br>
                <input type="text" name="year" placeholder="Year" style="text-align: center; max-width: 20%; font-size: 1.25rem; font-family:JetBrainsMono NFP, sans-serif;"><br>
                <div class="rating-group">
                    <label>
                        <input type="radio" name="rating" value="1"> <span>1</span>
                    </label>
                    <label>
                        <input type="radio" name="rating" value="2"> <span>2</span>
                    </label>
                    <label>
                        <input type="radio" name="rating" value="3"> <span>3</span>
                    </label>
                    <label>
                        <input type="radio" name="rating" value="4"> <span>4</span>
                    </label>
                    <label>
                        <input type="radio" name="rating" value="5"> <span>5</span>
                    </label>
                </div><br>        
                <div class="progression-group">
                    <label>
                        <input type="radio" name="progression" value="Unplayed🆕" checked> <span>Unplayed🆕</span>
                    </label>
                    <label>
                        <input type="radio" name="progression" value="Unfinished🔄️"> <span>Unfinished🔄️</span>
                    </label>
                    <label>
                        <input type="radio" name="progression" value="Complete✅"> <span>Complete✅</span>
                    </label>
                </div><br>
                <input type="text" name="collection" placeholder="Collection (Optional)"><br>
                <button type="submit" class="btn btn-add">Save</button>
            </form>
        </div>

        <div class="game-list">
            {% for game in games %}
            <div class="game">
                <h2 style="margin-bottom: -20px">{{ game[1] }}</h2>
                <p style="color: #bbb; font-style: italic; margin-bottom: -20px ">{{ game[2] }}</p>
        
                <!-- Progress -->
                <p style="margin-bottom: -20px ">
                    {% if game[5] == 'Unplayed🆕' %}
                    <span style="color: red;">{{ game[5] }}</span>
                    {% elif game[5] == 'Unfinished🔄️' %}
                    <span style="color: orange;">{{ game[5] }}</span>
                    {% elif game[5] == 'Complete✅' %}
                    <span style="color: rgb(8, 247, 8);">{{ game[5] }}</span>
                    {% else %}
                    <span>{{ game[5] }}</span>
                    {% endif %}
                </p>
        
                <p>{% if game[4] %} {{ game[4] }}/5 ⭐ {% else %} ~/5 ⭐ {% endif %}</p>
                <!-- <p style="color: lightblue; margin-bottom: -20px ">Collection: {{ game[7] if game[7] }}</p> -->
                <div class="btn-group">
                    <a href="/edit/{{ game[0] }}?sort_by={{ sort_by }}&order={{ order }}{% if current_collection_filter %}&collection={{ current_collection_filter }}{% endif %}" class="btn btn-edit"><i class="nf nf-fa-edit"></i></a>

                    <a href="/delete/{{ game[0] }}?sort_by={{ sort_by }}&order={{ order }}{% if current_collection_filter %}&collection={{ current_collection_filter }}{% endif %}" class="btn btn-delete"
                       onclick="return confirm('Are you sure you want to delete this game?');">
                       <i class="nf nf-md-delete"></i>
                    </a>
                
                    <a href="https://www.youtube.com/results?search_query={{ game[1]|urlencode }}+review" class="btn btn-ytreview" target="_blank">
                        <i class="nf nf-fa-youtube"></i>
                    </a>
                </div>
                
                <div class="img-wrapper">
                    <a href="{{ game[6] if game[6] else '#' }}"> <img src="{{ game[3] }}" alt="{{ game[1] }}"> </a>
                </div>
        
            </div>
            {% endfor %}
        </div>
        </div>
</body>
</html>